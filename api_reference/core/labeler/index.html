
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sweav02.github.io/baderkit/api_reference/core/labeler/">
      
      
        <link rel="prev" href="../grid/">
      
      
        <link rel="next" href="../labeler_spin/">
      
      
        
      
      
      <link rel="icon" href="../../../images/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ElfLabeler - BaderKit Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="BaderKit Documentation" class="md-header__button md-logo" aria-label="BaderKit Documentation" data-md-component="logo">
      
  <img src="../../../images/logo_icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BaderKit Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ElfLabeler
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/SWeav02/baderkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BaderKit Documentation" class="md-nav__button md-logo" aria-label="BaderKit Documentation" data-md-component="logo">
      
  <img src="../../../images/logo_icon.svg" alt="logo">

    </a>
    BaderKit Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SWeav02/baderkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bader
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    BadELF
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    BadELF
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ElfLabeler
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    ElfLabeler
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../elf_labeler/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../elf_labeler/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ElfLabeler
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ElfLabeler
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler" class="md-nav__link">
    <span class="md-ellipsis">
      
        ElfLabeler
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_types_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_feature_indices_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_feature_indices_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_max_values_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_max_values_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_types_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        bifurcation_graph
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        bifurcation_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electride_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        electride_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electrides_per_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_reduced_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electrides_per_reduced_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_average_frac_coords" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_average_frac_coords
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_avg_surface_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_avg_surface_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_dists_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms_dists_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_nums
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_nums_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_frac_coords" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_frac_coords
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_max_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_max_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_surface_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_min_surface_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_min_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.labeled_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        labeled_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        nearest_neighbor_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        nearest_neighbor_data_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nelectrides" class="md-nav__link">
    <span class="md-ellipsis">
      
        nelectrides
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.num_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_electron_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_electron_number
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_charge" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_charge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_mask
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_indices_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_indices_by_type
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.from_vasp" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_vasp
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_charges_and_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_charges_and_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure_by_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_structure_by_index
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_oxidation_and_volumes_from_potcar" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_oxidation_and_volumes_from_potcar
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_all_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_bifurcation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_bifurcation_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_feature_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_feature_basins_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_features_by_type
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_features_by_type_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_json
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../labeler_spin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpinElfLabeler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../badelf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Badelf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../badelf_spin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpinBadelf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Plotting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/bader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler" class="md-nav__link">
    <span class="md-ellipsis">
      
        ElfLabeler
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_elf_radii_types_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_feature_indices_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_feature_indices_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_max_values_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_max_values_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_nn_elf_radii_types_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        bifurcation_graph
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        bifurcation_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electride_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        electride_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electrides_per_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_reduced_formula" class="md-nav__link">
    <span class="md-ellipsis">
      
        electrides_per_reduced_formula
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_average_frac_coords" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_average_frac_coords
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_avg_surface_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_avg_surface_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_dists_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms_dists_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_atoms_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_nums
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_coord_nums_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_frac_coords" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_frac_coords
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_max_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_max_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_surface_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_min_surface_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_min_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_types
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.labeled_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        labeled_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        nearest_neighbor_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data_e" class="md-nav__link">
    <span class="md-ellipsis">
      
        nearest_neighbor_data_e
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nelectrides" class="md-nav__link">
    <span class="md-ellipsis">
      
        nelectrides
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.num_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_electron_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_electron_number
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_charge" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_charge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_mask
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_indices_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_indices_by_type
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.from_vasp" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_vasp
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_charges_and_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_charges_and_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure_by_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_feature_structure_by_index
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_oxidation_and_volumes_from_potcar" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_oxidation_and_volumes_from_potcar
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_all_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_bifurcation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_bifurcation_plot
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_feature_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_feature_basins_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_features_by_type
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_features_by_type_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_json
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>ElfLabeler</h1>

<div class="doc doc-object doc-class">



<a id="src.baderkit.core.labelers.elf_labeler.ElfLabeler"></a>
    <div class="doc doc-contents first">



        <p>Labels chemical features present in the ELF and collects various properties
e.g charge, volume, elf value, etc.
This is originally designed for analyzing electride materials, but could be
quite useful for bond analysis as well.</p>
<p>This class is designed only for single spin or total spin charge densities
and ELF. For spin-dependent systems, use the SpinElfLabeler instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_grid</code>
            </td>
            <td>
                  <code><span title="baderkit.core.Grid">Grid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge density grid used for integrating charge.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_grid</code>
            </td>
            <td>
                  <code><span title="baderkit.core.Grid">Grid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ELF grid used to partition volumes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_low_pseudopotentials</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to ignore errors associated with the use of pseudopotentials
with limited valence electrons. The default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shared_shell_ratio</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ratio used to determine if shallow nodes surrounding an atom should
be considered as a single shell feature.</p>
<p>Highly symmetric features such
as atom shells will often split into smaller features at a high isosurface
value very close to the maximum value in these smaller features. This
ratio refers to the range of values the ELF feature exists as a
single feature divided by the highest ELF value in the feature.</p>
<p>As covalency increases, this ratio will decrease as the small features
grow and eventually form large covalent features that align along a bond.
Thus, this parameter is in some ways a cutoff for considering a
feature a covalent bond versus an ionic shell. The default is 0.75.</p>
              </div>
            </td>
            <td>
                  <code>0.75</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>covalent_molecule_ratio</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ratio used to determine if an ELF feature belongs to one or multiple
atomic shell systems.</p>
<p>The covalent-ionic spectrum can be visualized in the ELF by comparing
the ELF values at which Shell-like features form and fully surround
atoms. "Fully surround" in this case means there is a void space
within the shell that is not the same surface as the outside of the shell.
In ionic bonds, the outermost shells will fully surround a single atom
at a relatively high ELF value and will not connect to other features
to surround additional atoms until considerably lower ELF values.
In contrast, homogenous covalent bonds will never fully surround 1 atom,
instead surrounding at least two when they first form a shell-like
shape. Heterogenous covalent bonds sit somewhere between the two,
surrounding a single atom for a small range of values before connecting
to a feature surrounding additional atoms.</p>
<p>The ratio here is the range of ELF values where the feature belongs
to a parent feature surrounding multiple atoms divided by the range of values
where it belongs to a parent feature surrounding only 1 atoms. This
ratio can be fairly low even for slight EN differences, though it is
usually significantly lower in clear ionic cases.
The default is 0.2.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>combine_shells</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to combine the Bader basins making up a shell into a
single feature. This is likely a more reasonable chemical perspective
and reduces differences that arise from the inability of a regular
cartesian grid to represent spherical shells. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_covalent_charge</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum charge that a feature must have to be considered covalent.
This exists primarily to distinguish between highly covalent features
and metallic features. The default is 0.6.</p>
              </div>
            </td>
            <td>
                  <code>0.6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_covalent_angle</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum angle between the two atoms and potential covalent feature for
the feature to be considered a covalent bond. For example, most single
covalent bonds sit exactly along the bond with an angle of 180. Triple
bonds and metallic bonds with covalent-like behavior may form ring
like shapes due to digeneracy with maxima slightly of the bond, decreasing
this angle. The default is 135.</p>
              </div>
            </td>
            <td>
                  <code>135</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_metal_depth</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum depth a feature can have and be considered metallic. Features
between multiple atoms with a depth lower than this value will be marked
as metallic. The default is 0.1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_electride_elf_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum ELF value for a feature to be considered an electride rather
than a multi-centered bond. The default is 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_electride_depth</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum range of ELF values a feature must exist distinctly to
be considered an electride rather than a multi-centered bond. The default is 0.2.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_electride_charge</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum charge a feature must have to be considered an electride
rather than a multi-centered bond. The default is 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_electride_volume</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum volume a feature must have to be considered an electride
rather than a multi-centered bond. The default is 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_electride_dist_beyond_atom</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum distance beyond the atoms radius that an electride must
sit to be considered an electride rather than a multi-centered bond. The radius
is calculated as the minimum in the ELF between two atoms. If a covalent
or metallic bond is present, the maximum is used instead. The default is 0.3.</p>
              </div>
            </td>
            <td>
                  <code>0.3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crystalnn_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keyword arguments used to create the CrystalNN object used for
nearest neighbor calculations. This is only important for calculating
charges on atoms when splitting covalent/metallic features to their
nearest neighbors.</p>
              </div>
            </td>
            <td>
                  <code>{&#39;distance_cutoffs&#39;: None, &#39;x_diff_weight&#39;: 0.0, &#39;porous_adjustment&#39;: False}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vacuum_tol</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tolerance for considering a region to be part of the vacuum. The
tolerance is compared to the charge density, not the ELF. The default
is 0.001.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shallow_reducible_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cutoff for removing shallow reducible domains. If the ratio of a
domains depth to its parents depth is below this value, it will be
removed. This is primarily to handle small differences due to voxelation.
The default of 0.05 is usually sufficient.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shallow_irreducible_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cutoff for combining shallow irreducible domains. If all children of
a reducible node have depths significantly lower than its own, they will
be combined into a single irreducible domain.. This is primarily to handle
small differences due to voxelation or very small/shallow basins.
The default of 0.1 is usually sufficient.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Bader class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ElfLabeler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Labels chemical features present in the ELF and collects various properties</span>
<span class="sd">    e.g charge, volume, elf value, etc.</span>
<span class="sd">    This is originally designed for analyzing electride materials, but could be</span>
<span class="sd">    quite useful for bond analysis as well.</span>

<span class="sd">    This class is designed only for single spin or total spin charge densities</span>
<span class="sd">    and ELF. For spin-dependent systems, use the SpinElfLabeler instead.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_grid : Grid</span>
<span class="sd">        The charge density grid used for integrating charge.</span>
<span class="sd">    reference_grid : Grid</span>
<span class="sd">        The ELF grid used to partition volumes.</span>
<span class="sd">    ignore_low_pseudopotentials : bool, optional</span>
<span class="sd">        Whether or not to ignore errors associated with the use of pseudopotentials</span>
<span class="sd">        with limited valence electrons. The default is False.</span>
<span class="sd">    shared_shell_ratio : float, optional</span>
<span class="sd">        The ratio used to determine if shallow nodes surrounding an atom should</span>
<span class="sd">        be considered as a single shell feature.</span>

<span class="sd">        Highly symmetric features such</span>
<span class="sd">        as atom shells will often split into smaller features at a high isosurface</span>
<span class="sd">        value very close to the maximum value in these smaller features. This</span>
<span class="sd">        ratio refers to the range of values the ELF feature exists as a</span>
<span class="sd">        single feature divided by the highest ELF value in the feature.</span>

<span class="sd">        As covalency increases, this ratio will decrease as the small features</span>
<span class="sd">        grow and eventually form large covalent features that align along a bond.</span>
<span class="sd">        Thus, this parameter is in some ways a cutoff for considering a</span>
<span class="sd">        feature a covalent bond versus an ionic shell. The default is 0.75.</span>
<span class="sd">    covalent_molecule_ratio : float, optional</span>
<span class="sd">        The ratio used to determine if an ELF feature belongs to one or multiple</span>
<span class="sd">        atomic shell systems.</span>

<span class="sd">        The covalent-ionic spectrum can be visualized in the ELF by comparing</span>
<span class="sd">        the ELF values at which Shell-like features form and fully surround</span>
<span class="sd">        atoms. &quot;Fully surround&quot; in this case means there is a void space</span>
<span class="sd">        within the shell that is not the same surface as the outside of the shell.</span>
<span class="sd">        In ionic bonds, the outermost shells will fully surround a single atom</span>
<span class="sd">        at a relatively high ELF value and will not connect to other features</span>
<span class="sd">        to surround additional atoms until considerably lower ELF values.</span>
<span class="sd">        In contrast, homogenous covalent bonds will never fully surround 1 atom,</span>
<span class="sd">        instead surrounding at least two when they first form a shell-like</span>
<span class="sd">        shape. Heterogenous covalent bonds sit somewhere between the two,</span>
<span class="sd">        surrounding a single atom for a small range of values before connecting</span>
<span class="sd">        to a feature surrounding additional atoms.</span>

<span class="sd">        The ratio here is the range of ELF values where the feature belongs</span>
<span class="sd">        to a parent feature surrounding multiple atoms divided by the range of values</span>
<span class="sd">        where it belongs to a parent feature surrounding only 1 atoms. This</span>
<span class="sd">        ratio can be fairly low even for slight EN differences, though it is</span>
<span class="sd">        usually significantly lower in clear ionic cases.</span>
<span class="sd">        The default is 0.2.</span>
<span class="sd">    combine_shells : bool, optional</span>
<span class="sd">        Whether or not to combine the Bader basins making up a shell into a</span>
<span class="sd">        single feature. This is likely a more reasonable chemical perspective</span>
<span class="sd">        and reduces differences that arise from the inability of a regular</span>
<span class="sd">        cartesian grid to represent spherical shells. The default is True.</span>
<span class="sd">    min_covalent_charge : float, optional</span>
<span class="sd">        The minimum charge that a feature must have to be considered covalent.</span>
<span class="sd">        This exists primarily to distinguish between highly covalent features</span>
<span class="sd">        and metallic features. The default is 0.6.</span>
<span class="sd">    min_covalent_angle : float, optional</span>
<span class="sd">        The minimum angle between the two atoms and potential covalent feature for</span>
<span class="sd">        the feature to be considered a covalent bond. For example, most single</span>
<span class="sd">        covalent bonds sit exactly along the bond with an angle of 180. Triple</span>
<span class="sd">        bonds and metallic bonds with covalent-like behavior may form ring</span>
<span class="sd">        like shapes due to digeneracy with maxima slightly of the bond, decreasing</span>
<span class="sd">        this angle. The default is 135.</span>
<span class="sd">    max_metal_depth : float, optional</span>
<span class="sd">        The maximum depth a feature can have and be considered metallic. Features</span>
<span class="sd">        between multiple atoms with a depth lower than this value will be marked</span>
<span class="sd">        as metallic. The default is 0.1.</span>
<span class="sd">    min_electride_elf_value : float, optional</span>
<span class="sd">        The minimum ELF value for a feature to be considered an electride rather</span>
<span class="sd">        than a multi-centered bond. The default is 0.5.</span>
<span class="sd">    min_electride_depth : float, optional</span>
<span class="sd">        The minimum range of ELF values a feature must exist distinctly to</span>
<span class="sd">        be considered an electride rather than a multi-centered bond. The default is 0.2.</span>
<span class="sd">    min_electride_charge : float, optional</span>
<span class="sd">        The minimum charge a feature must have to be considered an electride</span>
<span class="sd">        rather than a multi-centered bond. The default is 0.5.</span>
<span class="sd">    min_electride_volume : float, optional</span>
<span class="sd">        The minimum volume a feature must have to be considered an electride</span>
<span class="sd">        rather than a multi-centered bond. The default is 10.</span>
<span class="sd">    min_electride_dist_beyond_atom : float, optional</span>
<span class="sd">        The minimum distance beyond the atoms radius that an electride must</span>
<span class="sd">        sit to be considered an electride rather than a multi-centered bond. The radius</span>
<span class="sd">        is calculated as the minimum in the ELF between two atoms. If a covalent</span>
<span class="sd">        or metallic bond is present, the maximum is used instead. The default is 0.3.</span>
<span class="sd">    crystalnn_kwargs : dict, optional</span>
<span class="sd">        The keyword arguments used to create the CrystalNN object used for</span>
<span class="sd">        nearest neighbor calculations. This is only important for calculating</span>
<span class="sd">        charges on atoms when splitting covalent/metallic features to their</span>
<span class="sd">        nearest neighbors.</span>
<span class="sd">    vacuum_tol : float | bool, optional</span>
<span class="sd">        The tolerance for considering a region to be part of the vacuum. The</span>
<span class="sd">        tolerance is compared to the charge density, not the ELF. The default</span>
<span class="sd">        is 0.001.</span>
<span class="sd">    shallow_reducible_cutoff : float, optional</span>
<span class="sd">        The cutoff for removing shallow reducible domains. If the ratio of a</span>
<span class="sd">        domains depth to its parents depth is below this value, it will be</span>
<span class="sd">        removed. This is primarily to handle small differences due to voxelation.</span>
<span class="sd">        The default of 0.05 is usually sufficient.</span>
<span class="sd">    shallow_irreducible_cutoff : float, optional</span>
<span class="sd">        The cutoff for combining shallow irreducible domains. If all children of</span>
<span class="sd">        a reducible node have depths significantly lower than its own, they will</span>
<span class="sd">        be combined into a single irreducible domain.. This is primarily to handle</span>
<span class="sd">        small differences due to voxelation or very small/shallow basins.</span>
<span class="sd">        The default of 0.1 is usually sufficient.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments to pass to the Bader class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_labeled_covalent</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_labeled_multi</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">spin_system</span> <span class="o">=</span> <span class="s2">&quot;total&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">charge_grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span>
        <span class="n">reference_grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span>
        <span class="n">ignore_low_pseudopotentials</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">shared_shell_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span>
        <span class="n">covalent_molecule_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="n">combine_shells</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">min_covalent_charge</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
        <span class="n">min_covalent_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">135</span><span class="p">,</span>
        <span class="n">max_metal_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">min_electride_elf_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">min_electride_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="n">min_electride_charge</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">min_electride_volume</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">min_electride_dist_beyond_atom</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="n">crystalnn_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;distance_cutoffs&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;x_diff_weight&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s2">&quot;porous_adjustment&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">vacuum_tol</span><span class="o">=</span><span class="mf">1.0e-03</span><span class="p">,</span>
        <span class="n">shallow_reducible_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">shallow_irreducible_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="c1"># ensure the reference file is ELF</span>
        <span class="k">if</span> <span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span> <span class="o">!=</span> <span class="s2">&quot;elf&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;A non-ELF reference file has been detected. Results may not be valid.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span> <span class="o">=</span> <span class="n">charge_grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span> <span class="o">=</span> <span class="n">reference_grid</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_low_pseudopotentials</span> <span class="o">=</span> <span class="n">ignore_low_pseudopotentials</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crystalnn_kwargs</span> <span class="o">=</span> <span class="n">crystalnn_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnn</span> <span class="o">=</span> <span class="n">CrystalNN</span><span class="p">(</span><span class="o">**</span><span class="n">crystalnn_kwargs</span><span class="p">)</span>
        <span class="c1"># BUGFIX: We use a separate cnn with very loose rules to find neighbors</span>
        <span class="c1"># that may potentially have the smallest radius. This is intentionally</span>
        <span class="c1"># separate from the cnn used to calculate NNs for features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radii_cnn</span> <span class="o">=</span> <span class="n">CrystalNN</span><span class="p">(</span>
            <span class="n">weighted_cn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">distance_cutoffs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">x_diff_weight</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">porous_adjustment</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># define cutoff variables</span>
        <span class="c1"># TODO: These should be hidden variables to allow for setter methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_shell_ratio</span> <span class="o">=</span> <span class="n">shared_shell_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covalent_molecule_ratio</span> <span class="o">=</span> <span class="n">covalent_molecule_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_shells</span> <span class="o">=</span> <span class="n">combine_shells</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span> <span class="o">=</span> <span class="n">min_covalent_charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_angle</span> <span class="o">=</span> <span class="n">min_covalent_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shallow_reducible_cutoff</span> <span class="o">=</span> <span class="n">shallow_reducible_cutoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shallow_irreducible_cutoff</span> <span class="o">=</span> <span class="n">shallow_irreducible_cutoff</span>

        <span class="c1"># electride cutoffs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_elf_value</span> <span class="o">=</span> <span class="n">min_electride_elf_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_charge</span> <span class="o">=</span> <span class="n">min_electride_charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_depth</span> <span class="o">=</span> <span class="n">min_electride_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_charge</span> <span class="o">=</span> <span class="n">min_electride_charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_volume</span> <span class="o">=</span> <span class="n">min_electride_volume</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_dist_beyond_atom</span> <span class="o">=</span> <span class="n">min_electride_dist_beyond_atom</span>

        <span class="c1"># define properties that will be updated by running the method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_graph</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_plot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_feature_indices_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_max_values_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes_e</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_formula</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_reduced_formula</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create a bader object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bader</span> <span class="o">=</span> <span class="n">Bader</span><span class="p">(</span>
            <span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span>
            <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span>
            <span class="n">vacuum_tol</span><span class="o">=</span><span class="n">vacuum_tol</span><span class="p">,</span>
            <span class="n">use_reference_vacuum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># TODO: Make these reset on a change similar to the Bader class. Add docs</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Bifurcation Properties</span>
    <span class="c1">###########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bifurcation_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BifurcationGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        BifurcationGraph</span>
<span class="sd">            A BifurcationGraph class representing features and bifurcations in the</span>
<span class="sd">            ELF.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_bifurcation_graph</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_graph</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bifurcation_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        go.Figure</span>
<span class="sd">            A plotly graph object representing the bifurcation graph.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_plot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">get_plot</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_plot</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Structure Properties</span>
    <span class="c1">###########################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Structure</span>
<span class="sd">            The PyMatGen Structure representing the system.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">structure</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electride_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Structure</span>
<span class="sd">            The system&#39;s structure including dummy atoms representing electride</span>
<span class="sd">            sites.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">electride_structure</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">labeled_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Structure</span>
<span class="sd">            The system&#39;s structure including dummy atoms representing electride</span>
<span class="sd">            sites and covalent/metallic bonds. Features unique to the spin-up/spin-down</span>
<span class="sd">            systems will have xu or xd appended to the species name respectively.</span>
<span class="sd">            Features that exist in both will have nothing appended.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">labeled_structure</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nelectrides</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of electride sites in the structure</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electride_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A string representation of the electride formula, rounding partial charge</span>
<span class="sd">            to the nearest integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2"> e</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electrides_per_formula</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electrides_per_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The number of electride electrons for the full structure formula.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_formula</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">electrides_per_unit</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                    <span class="n">electrides_per_unit</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_formula</span> <span class="o">=</span> <span class="n">electrides_per_unit</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_formula</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electrides_per_reduced_formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The number of electrons in the reduced formula of the structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_reduced_formula</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="n">_</span><span class="p">,</span>
                <span class="n">formula_reduction_factor</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">get_reduced_composition_and_factor</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_reduced_formula</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">electrides_per_formula</span> <span class="o">/</span> <span class="n">formula_reduction_factor</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_electrides_per_reduced_formula</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Coordination Environment</span>
    <span class="c1">###########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nearest_neighbor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            The nearest neighbor data for the atoms in the system represented as</span>
<span class="sd">            a tuple of arrays. The arrays represent, in order, the central</span>
<span class="sd">            atoms index, its neighbors index, the fractional coordinates of the</span>
<span class="sd">            neighbor, and the distance between the two sites.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># run bifurcation assignment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nearest_neighbor_data_e</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            The nearest neighbor data for the atoms AND the electrides</span>
<span class="sd">            in the system represented as a tuple of arrays. The arrays represent,</span>
<span class="sd">            in order, the central atoms index, its neighbors index, the fractional</span>
<span class="sd">            coordinates of the neighbor, and the distance between the two sites.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># run assignment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii_e</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data_e</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Atom and Electride quasi-atom Properties</span>
    <span class="c1">###########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_elf_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The radius of each atom calculated from the ELF using the closest</span>
<span class="sd">            neighboring atom in the structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_atom_elf_radii</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nearest_neighbor_data</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_elf_radii_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The type of radius of each elf radius. Covalent indicates that the</span>
<span class="sd">            bond crosses through some covalent or metallic region, and the radius</span>
<span class="sd">            is placed at the maximum in the ELF in this region. Ionic indicates</span>
<span class="sd">            that the bond does not pass through the covalent/metallic region and</span>
<span class="sd">            the radius is placed at the minimum between the two atoms.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># run labeling and radii calc by calling our bifurcation graph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types</span><span class="p">,</span> <span class="s2">&quot;covalent&quot;</span><span class="p">,</span> <span class="s2">&quot;ionic&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_elf_radii_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The radius of each atom and electride site calculated from the ELF</span>
<span class="sd">            using the closest neighboring atom/electride in the structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># make sure bifurcation graph has been constructed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span>
            <span class="c1"># calculate elf radii</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types_e</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_atom_elf_radii</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii_e</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types_e</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nearest_neighbor_data_e</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_e</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_elf_radii_types_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The type of radius of each atom/electride elf radius. Covalent indicates that the</span>
<span class="sd">            bond crosses through some covalent or metallic region, and the radius</span>
<span class="sd">            is placed at the maximum in the ELF in this region. Ionic indicates</span>
<span class="sd">            that the bond does not pass through the covalent/metallic region and</span>
<span class="sd">            the radius is placed at the minimum between the two atoms.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># run labeling and radii calc by calling our bifurcation graph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii_e</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atom_elf_radii_types_e</span><span class="p">,</span> <span class="s2">&quot;covalent&quot;</span><span class="p">,</span> <span class="s2">&quot;ionic&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_nn_elf_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The elf radii for each atom and its neighboring atoms in the same</span>
<span class="sd">            order as the nearest_neighbor_data property.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_nn_elf_radii_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The type of radius for each atom and its neighboring atoms in the same</span>
<span class="sd">            order as the nearest_neighbor_data property.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># call radii method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span><span class="p">,</span> <span class="s2">&quot;covalent&quot;</span><span class="p">,</span> <span class="s2">&quot;ionic&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_nn_elf_radii_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The elf radii for each atom/electride and its neighboring atoms in the same</span>
<span class="sd">            order as the nearest_neighbor_data_e property.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># make sure labeled bifurcation graph exists</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labeled_covalent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span>
            <span class="c1"># if there are no electride atoms, just return the results for the base</span>
            <span class="c1"># structure (avoid repeat calc)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_neighbor_data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">(</span>
                    <span class="n">site_indices</span><span class="p">,</span>
                    <span class="n">neigh_indices</span><span class="p">,</span>
                    <span class="n">neigh_coords</span><span class="p">,</span>
                    <span class="n">radii</span><span class="p">,</span>
                    <span class="n">dists</span><span class="p">,</span>
                    <span class="n">bond_types</span><span class="p">,</span>
                    <span class="n">plane_points</span><span class="p">,</span>
                    <span class="n">plane_vectors</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_nn_atom_elf_radii</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_e</span> <span class="o">=</span> <span class="n">radii</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types_e</span> <span class="o">=</span> <span class="n">bond_types</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data_e</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">site_indices</span><span class="p">,</span>
                    <span class="n">neigh_indices</span><span class="p">,</span>
                    <span class="n">neigh_coords</span><span class="p">,</span>
                    <span class="n">dists</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes_e</span> <span class="o">=</span> <span class="p">(</span><span class="n">plane_points</span><span class="p">,</span> <span class="n">plane_vectors</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_e</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_nn_elf_radii_types_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The type of radius for each atom/electride and its neighboring atoms in the same</span>
<span class="sd">            order as the nearest_neighbor_data property.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># call radii method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom_nn_elf_radii_e</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span><span class="p">,</span> <span class="s2">&quot;covalent&quot;</span><span class="p">,</span> <span class="s2">&quot;ionic&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_feature_indices_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The feature indices assigned to each atom/electride in the electride</span>
<span class="sd">            structure. Features assigned to multiple atoms are not included.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># For each atom, a list of feature indices that belong solely to that</span>
        <span class="c1"># atom</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_feature_indices_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">atom_features</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span><span class="p">))]</span>
            <span class="c1"># add atom indices</span>
            <span class="k">for</span> <span class="n">feat_idx</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">coord_number</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span>
                <span class="p">):</span>
                    <span class="n">atom_features</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">coord_indices_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
            <span class="c1"># add electride indices</span>
            <span class="n">electride_num</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                    <span class="n">atom_features</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="n">electride_num</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">electride_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_feature_indices_e</span> <span class="o">=</span> <span class="n">atom_features</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_feature_indices_e</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_max_values_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The maximum value that each atom has an existing feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_max_values_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feature_max_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_max_values</span>
            <span class="n">max_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature_indices</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_feature_indices_e</span><span class="p">):</span>
                <span class="n">max_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_max_values</span><span class="p">[</span><span class="n">feature_indices</span><span class="p">]))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_max_values_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">max_values</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_max_values_e</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Vacuum Properties</span>
    <span class="c1">###########################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The charge assigned to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">vacuum_charge</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total volume assigned to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">vacuum_volume</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[bool]</span>
<span class="sd">            A mask representing the voxels that belong to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">vacuum_mask</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_vacuum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of vacuum points in the array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">num_vacuum</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_electron_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total number of electrons in the system calculated from the</span>
<span class="sd">            atom charges and vacuum charge. If this does not match the true</span>
<span class="sd">            total electron number within reasonable floating point error,</span>
<span class="sd">            there is a major problem.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_charge</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total volume integrated in the system. This should match the</span>
<span class="sd">            volume of the structure. If it does not there may be a serious problem.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_volumes</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_volume</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Feature Properties</span>
    <span class="c1">###########################################################################</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_feature_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects the request property for each feature in the BifurcationGraph</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        property_name : str</span>
<span class="sd">            The name of the property to collect</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        features : list</span>
<span class="sd">            The properties for each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">:</span>
            <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">property_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">features</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[str]</span>
<span class="sd">            The type of each ELF feature in the system.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;feature_type&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_basins</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[NDArray]</span>
<span class="sd">            The Bader basins associated with each feature. For features with</span>
<span class="sd">            multiple basins, the basins are separated by very shallow minima</span>
<span class="sd">            and are better understood as a single feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;basins&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_frac_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[NDArray]</span>
<span class="sd">            The fractional coordinates of the maxima in each Bader basin</span>
<span class="sd">            for each feature in the structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;frac_coords&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_average_frac_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The average fractional coordinates of the Bader basin maxima for each</span>
<span class="sd">            feature. Note that it is possible for this coordinate to be outside</span>
<span class="sd">            of the feature, particularly for atom shells which form sphere-like</span>
<span class="sd">            shapes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;average_frac_coords&quot;</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_max_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The maximum value at which each feature exists.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;max_value&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_min_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The minimum value at which each feature exists.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;min_value&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_charges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The charge associated with each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;charge&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The volume associated with each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The atoms coordinated with each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_indices&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_nums</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The number of atoms coordinated with each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_number&quot;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The distance to each coordinated atom from each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_dists&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_atoms_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The coordinated atoms to each feature, including electrides as quasi-atoms</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_indices_e&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_nums_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The number of coordinated atoms for each featuree, including</span>
<span class="sd">            electrides as quasi-atoms.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_number_e&quot;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_coord_atoms_dists_e</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The distance to each coordinated atom/electride from each feature.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;coord_dists_e&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_min_surface_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The minimum distance from the average frac coord of each feature to the</span>
<span class="sd">            partitioning surface.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;min_surface_dist&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_avg_surface_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The average distance from the average frac coord of each feature to the</span>
<span class="sd">            partitioning surface.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_feature_properties</span><span class="p">(</span><span class="s2">&quot;avg_surface_dist&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Helpful Methods</span>
    <span class="c1">###########################################################################</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">feature_indices_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets a list of feature indices from a list of types of Features</span>
<span class="sd">        (e.g. bare electron, metallic, covalent)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature_types : list[FeatureType | str]</span>
<span class="sd">            The list of feature types to find indices for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            A list of feature indices corresponding to all feature types in the</span>
<span class="sd">            provided list. These correspond to the order in which feature properties</span>
<span class="sd">            (e.g. ElfLabeler.feature_charges) appear in.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">)</span> <span class="k">if</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">feature_types</span><span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span> <span class="n">use_electrides</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the oxidation states, charges, and volumes associated with each</span>
<span class="sd">        atom/electride using the information from a provided POTCAR.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        potcar_path : Path, optional</span>
<span class="sd">            The path to the POTCAR file. The default is &quot;POTCAR&quot;.</span>
<span class="sd">        use_electrides : bool, optional</span>
<span class="sd">            Whether or not to treat electrides as quasi atoms. The default is True.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Any keyword arguments to pass to the &#39;get_charges_and_volumes&#39; method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[NDArray]</span>
<span class="sd">            three arrays representing the oxidation states, charges, and volumes</span>
<span class="sd">            respectively.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span>
            <span class="n">use_electrides</span><span class="o">=</span><span class="n">use_electrides</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="c1"># convert to path</span>
        <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
        <span class="c1"># load</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">potcars</span> <span class="o">=</span> <span class="n">Potcar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
        <span class="n">nelectron_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># the result is a list because there can be multiple element potcars</span>
        <span class="c1"># in the file (e.g. for NaCl, POTCAR = POTCAR_Na + POTCAR_Cl)</span>
        <span class="k">for</span> <span class="n">potcar</span> <span class="ow">in</span> <span class="n">potcars</span><span class="p">:</span>
            <span class="n">nelectron_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">potcar</span><span class="o">.</span><span class="n">element</span><span class="p">:</span> <span class="n">potcar</span><span class="o">.</span><span class="n">nelectrons</span><span class="p">})</span>
        <span class="c1"># calculate oxidation states</span>
        <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

        <span class="n">oxi_state_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site</span><span class="p">,</span> <span class="n">site_charge</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">charges</span><span class="p">):</span>
            <span class="n">element_str</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span>
            <span class="n">val_electrons</span> <span class="o">=</span> <span class="n">nelectron_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element_str</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">oxi_state</span> <span class="o">=</span> <span class="n">val_electrons</span> <span class="o">-</span> <span class="n">site_charge</span>
            <span class="n">oxi_state_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxi_state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">oxi_state_data</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">charges</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">volumes</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_charges_and_volumes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">splitting_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span> <span class="s2">&quot;pauling&quot;</span><span class="p">,</span> <span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="s2">&quot;nearest&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span>
        <span class="n">use_electrides</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign charge from each feature to their associated atoms. For features</span>
<span class="sd">        that have multiple neighbors (e.g. covalent bonds), several options</span>
<span class="sd">        are provided for how to divide the charge to nearby neighbors.</span>
<span class="sd">        If use_electrides is set to True, features with electride like character</span>
<span class="sd">        will be treated as atoms and</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        splitting_method : Literal[&quot;equal&quot;, &quot;pauling&quot;, &quot;dist&quot;, &quot;weighted_dist&quot;, &quot;nearest&quot;], optional</span>
<span class="sd">            The method used to divide charge and volume of shared features</span>
<span class="sd">            betweeen their coordinating atoms.</span>

<span class="sd">                &#39;weighted_dist&#39; (default)</span>
<span class="sd">                    Fraction increases with decreasing distance to each atom. The</span>
<span class="sd">                    fraction is further weighted by the radius of each atom</span>
<span class="sd">                    calculated from the ELF</span>
<span class="sd">                &#39;pauling&#39;</span>
<span class="sd">                    Fraction increases with decreasing pauling electronegativity.</span>
<span class="sd">                    If an atom has no recorded EN a value of 2.2 is used which</span>
<span class="sd">                    may be incorrect in many cases.</span>
<span class="sd">                &#39;equal&#39;</span>
<span class="sd">                    Each neighboring atom receives an equal fraction.</span>
<span class="sd">                &#39;dist&#39;</span>
<span class="sd">                    Fraction increases with decreasing distance to the center</span>
<span class="sd">                    of each atom</span>
<span class="sd">                &#39;nearest&#39;</span>
<span class="sd">                    All charge is assigned to the features nearest atom.</span>

<span class="sd">        use_electrides : bool, optional</span>
<span class="sd">            If True, features labeled as bare electrons will be treated as electride</span>
<span class="sd">            atoms. They will receive partial charge from other shared features</span>
<span class="sd">            and their charge/volume will be appended after the atoms&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[NDArray]</span>
<span class="sd">            Two arrays representing the charges and volumes respectively.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

        <span class="c1"># create an array to store atom charges and volumes</span>
        <span class="n">atom_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">atom_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

        <span class="c1"># if using pauling, get all electronegativities</span>
        <span class="k">if</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;pauling&quot;</span><span class="p">:</span>
            <span class="n">pauling_ens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">X</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">])</span>
            <span class="n">pauling_ens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">pauling_ens</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>

        <span class="n">electride_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">)):</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_volumes</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
                <span class="c1"># check if this is an electride feature</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                    <span class="c1"># assign charge/volume to self</span>
                    <span class="n">struc_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="n">electride_num</span>
                    <span class="n">atom_charge</span><span class="p">[</span><span class="n">struc_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
                    <span class="n">atom_volume</span><span class="p">[</span><span class="n">struc_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>
                    <span class="n">electride_num</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">continue</span>

                <span class="c1"># get coordination with electrides</span>
                <span class="n">coord_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get coordination without electrides</span>
                <span class="n">coord_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
            <span class="c1"># get unique atoms and counts (correction for small cells)</span>
            <span class="n">unique_atoms</span><span class="p">,</span> <span class="n">unique_indices</span><span class="p">,</span> <span class="n">atom_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
                <span class="n">coord_atoms</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># This shouldn&#39;t happen, but could if CrystalNN failed</span>
                <span class="c1"># to find neighbors.</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No neighboring atoms found for feature with index </span><span class="si">{</span><span class="n">feature_idx</span><span class="si">}</span><span class="s2">. Feature assigned to nearest atom.&quot;</span>
                <span class="p">)</span>
                <span class="c1"># assign all charge/volume to the closest atom</span>
                <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">])</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># all methods will add charge and volume to this atom.</span>
                <span class="c1"># assigning it here potentially avoids divide by zeros for</span>
                <span class="c1"># core features</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">charge</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">volume</span>

            <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;equal&quot;</span><span class="p">:</span>
                <span class="c1"># evenly split the feature to each neighboring atom</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">charge</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom_counts</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">volume</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom_counts</span>

            <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;pauling&quot;</span><span class="p">:</span>
                <span class="c1"># get the pauling ens for coordinated atoms</span>
                <span class="n">ens</span> <span class="o">=</span> <span class="n">pauling_ens</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>
                <span class="c1"># normalize to the total en</span>
                <span class="n">ens</span> <span class="o">/=</span> <span class="n">ens</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="c1"># get the weights for each unique atom</span>
                <span class="n">ens</span> <span class="o">=</span> <span class="n">ens</span><span class="p">[</span><span class="n">unique_indices</span><span class="p">]</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">ens</span> <span class="o">*</span> <span class="n">atom_counts</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">ens</span> <span class="o">*</span> <span class="n">atom_counts</span>

            <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;dist&quot;</span><span class="p">:</span>
                <span class="c1"># get the dist to each coordinated atom</span>
                <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
                    <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_dists_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># invert and normalize</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dists</span>
                <span class="n">dists</span> <span class="o">/=</span> <span class="n">dists</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="c1"># add for each atom</span>
                <span class="k">for</span> <span class="n">coord_idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">):</span>
                    <span class="n">atom_charge</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">dists</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>
                    <span class="n">atom_volume</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">dists</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">:</span>
                <span class="c1"># get the dist to each coordinated atom and their radii</span>
                <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
                    <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_dists_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">atom_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii_e</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">atom_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>

                <span class="c1"># calculate the weighted contribution to each atom and normalize</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">atom_radii</span> <span class="o">/</span> <span class="n">dists</span>
                <span class="n">weight</span> <span class="o">/=</span> <span class="n">weight</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                <span class="c1"># add for each atom</span>
                <span class="k">for</span> <span class="n">coord_idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">):</span>
                    <span class="n">atom_charge</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">weight</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>
                    <span class="n">atom_volume</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">weight</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;nearest&quot;</span><span class="p">:</span>
                <span class="c1"># assign all charge/volume to the closest atom</span>
                <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">])</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">splitting_method</span><span class="si">}</span><span class="s2">&#39; is not a valid splitting method&quot;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">atom_charge</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">atom_volume</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature_labels</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">included_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span>
        <span class="n">return_structure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_feat_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_charge_volume</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">order_by_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Assigns each grid point to atoms and features included in the &#39;included_features&#39;</span>
<span class="sd">        tag. The assignments are represented by an array with the same dimensions</span>
<span class="sd">        as the charge/reference grids with integers representing the atom/feature</span>
<span class="sd">        index in the Structure object including requested feature dummy atoms.</span>
<span class="sd">        By default this method orders requested features so that atoms</span>
<span class="sd">        come first, followed by electrides, and then any other feature types. This</span>
<span class="sd">        is for methods such as BadELF which rely on this ordering scheme.</span>

<span class="sd">        Atoms are included by default and it is generally not recommended to include</span>
<span class="sd">        core/shell features. If these are of interest to you, reach out to us</span>
<span class="sd">        on our [github](https://github.com/SWeav02/baderkit)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        included_features : list[str], optional</span>
<span class="sd">            The features to include in addition to the atoms. The default is FeatureType.valence_types.</span>
<span class="sd">        return_structure : bool, optional</span>
<span class="sd">            Whether or not to return the structure that the index labels correspond</span>
<span class="sd">            to. The default is True.</span>
<span class="sd">        return_feat_indices : bool, optional</span>
<span class="sd">            Whether or not to return the original feature indices in their new</span>
<span class="sd">            order. The default is False.</span>
<span class="sd">        order_by_type : bool, optional</span>
<span class="sd">            Whether or not to reorder the structure prior to assigning to</span>
<span class="sd">            grid points. The default is True.</span>
<span class="sd">        return_charge_volume : bool, optional</span>
<span class="sd">            Whether or not to return the corresponding charge/volume associated</span>
<span class="sd">            with each feature</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            An array representing grid point assignments. If return_structure or</span>
<span class="sd">            return_feat_indices is set to True, these are returned as well. The</span>
<span class="sd">            returned result is always a tuple, even if only the feature assignments</span>
<span class="sd">            are requested.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the original basin atom assignments</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># get indices of requested type</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_features</span><span class="p">)</span>

        <span class="c1"># reorder features so that electrides are first if requested</span>
        <span class="k">if</span> <span class="n">order_by_type</span><span class="p">:</span>
            <span class="n">bare_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">other_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                    <span class="n">bare_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">other_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
            <span class="n">feature_indices</span> <span class="o">=</span> <span class="n">bare_feature_indices</span> <span class="o">+</span> <span class="n">other_feature_indices</span>

        <span class="c1"># reassign basin atoms and get structure</span>
        <span class="n">feature_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_atom_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sorted_idx</span><span class="p">,</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">):</span>
            <span class="c1"># update basin labels</span>
            <span class="n">basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
            <span class="n">basin_atoms</span><span class="p">[</span><span class="n">basins</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_atom_idx</span>
            <span class="n">new_atom_idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># add feature to structure</span>
            <span class="n">species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span><span class="o">.</span><span class="n">dummy_species</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_average_frac_coords</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
            <span class="n">feature_structure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>

        <span class="c1"># NOTE: append -1 so that vacuum gets assigned to -1 in the atom_labels</span>
        <span class="c1"># array</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># reassign labels</span>
        <span class="n">feature_labels</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">]</span>

        <span class="c1"># get requested results</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">((</span><span class="n">return_structure</span><span class="p">,</span> <span class="n">return_feat_indices</span><span class="p">,</span> <span class="n">return_charge_volume</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">feature_labels</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature_labels</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_structure</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_feat_indices</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_charge_volume</span><span class="p">:</span>
            <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">atom_charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
                <span class="n">basin_atoms</span><span class="p">,</span>
                <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_charges</span><span class="p">,</span>
                <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">atom_volumes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
                <span class="n">basin_atoms</span><span class="p">,</span>
                <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_volumes</span><span class="p">,</span>
                <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_charges</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_volumes</span><span class="p">)</span>

        <span class="c1"># return labels</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">included_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span>
        <span class="n">return_feat_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">order_by_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Generates a PyMatGen Structure object with dummy atoms for each requested</span>
<span class="sd">        feature. By default this method orders requested features so that atoms</span>
<span class="sd">        come first, followed by electrides, and then any other feature types.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        included_features : list[str], optional</span>
<span class="sd">            The features to include in addition to the atoms. The default is FeatureType.valence_types.</span>
<span class="sd">        return_feat_indices : bool, optional</span>
<span class="sd">            Whether or not to return the original feature indices in their new</span>
<span class="sd">            order. The default is False.</span>
<span class="sd">        order_by_type : bool, optional</span>
<span class="sd">            Whether or not to reorder the structure. The default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Structure</span>
<span class="sd">            DESCRIPTION.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get indices of requested type</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_features</span><span class="p">)</span>

        <span class="c1"># reorder features so that electrides are first if requested</span>
        <span class="k">if</span> <span class="n">order_by_type</span><span class="p">:</span>
            <span class="n">bare_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">other_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                    <span class="n">bare_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">other_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
            <span class="n">feature_indices</span> <span class="o">=</span> <span class="n">bare_feature_indices</span> <span class="o">+</span> <span class="n">other_feature_indices</span>

        <span class="c1"># get structure from indices</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_feat_indices</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">structure</span><span class="p">,</span> <span class="n">feature_indices</span>

        <span class="k">return</span> <span class="n">structure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature_structure_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Generates a PyMatGen Structure object with dummy atoms for each requested</span>
<span class="sd">        feature. This method does not reorder features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature_indices : list[int]</span>
<span class="sd">            The indices of features to include.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        structure : Structure</span>
<span class="sd">            The system&#39;s PyMatGen Structure including dummy atoms representing</span>
<span class="sd">            requested features.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create a new structure without oxidation states</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">structure</span><span class="o">.</span><span class="n">remove_oxidation_states</span><span class="p">()</span>

        <span class="c1"># add each feature</span>
        <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
            <span class="n">structure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span><span class="o">.</span><span class="n">dummy_species</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feature_average_frac_coords</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">structure</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Hidden Utility Methods</span>
    <span class="c1">###########################################################################</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_nn_atom_elf_radii</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">use_electrides</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Calculate the ELF radius for all atom neighbor pairs that result in partitioning</span>
<span class="sd">        planes lying on the voronoi surface</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        use_electrides : bool, optional</span>
<span class="sd">            Whether or not to treat electrides as quasi-atoms. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            The radius for each atom/neighbor pair and their bond type (0=ionic, 1=covalent)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labeled_covalent</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Covalent features must be labeled for reliable radii.&quot;</span><span class="p">)</span>
        <span class="c1"># get appropriate structure and neighbor data</span>
        <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span>
            <span class="c1"># we don&#39;t treat electride atoms as metals in this case, as we are</span>
            <span class="c1"># treating them like quasi atoms</span>
            <span class="n">covalent_types</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>
            <span class="c1"># we do treat electride atoms as metals/covalent features</span>
            <span class="n">covalent_types</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span>

        <span class="c1"># Get a labeled structure including covalent, metallic, and bare</span>
        <span class="c1"># electron features</span>
        <span class="n">included_types</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">feature_labels</span><span class="p">,</span> <span class="n">feature_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_labels</span><span class="p">(</span>
            <span class="n">included_features</span><span class="o">=</span><span class="n">included_types</span>
        <span class="p">)</span>
        <span class="n">covalent_symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">dummy_species</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">covalent_types</span><span class="p">])</span>
        <span class="c1"># Calculate all radii on the voronoi surface</span>
        <span class="n">radii_tools</span> <span class="o">=</span> <span class="n">ElfRadiiTools</span><span class="p">(</span>
            <span class="n">grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="p">,</span>
            <span class="n">feature_labels</span><span class="o">=</span><span class="n">feature_labels</span><span class="p">,</span>
            <span class="n">feature_structure</span><span class="o">=</span><span class="n">feature_structure</span><span class="p">,</span>
            <span class="n">override_structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">covalent_symbols</span><span class="o">=</span><span class="n">covalent_symbols</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">radii_tools</span><span class="o">.</span><span class="n">get_voronoi_radii</span><span class="p">()</span>
        <span class="c1"># return radii_tools.get_crystalnn_radii()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_atom_elf_radii</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">all_radii</span><span class="p">,</span> <span class="n">all_radii_types</span><span class="p">,</span> <span class="n">nn_data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the smallest radius for each atom from the provided data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        structure : Structure</span>
<span class="sd">            The structure corresponding to the atoms to find radii for.</span>
<span class="sd">        all_radii : NDArray</span>
<span class="sd">            All radii between all atoms and their nearest neighbors.</span>
<span class="sd">        all_radii_types : NDArray</span>
<span class="sd">            All radii types for all atom/neighbor pairs.</span>
<span class="sd">        nn_data : NDArray</span>
<span class="sd">            Four arrays representing the coordination environment of the provided</span>
<span class="sd">            structure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            The radii and radius types for each atom (0=ionic, 1=covalent)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: This is the smallest radius of each atom which is not always</span>
        <span class="c1"># along the bond to the nearest neighbor, but typically is. For</span>
        <span class="c1"># example CdPt3 has 2 Pt atoms with a Cd an dPt atom tied for the</span>
        <span class="c1"># nearest.</span>
        <span class="n">site_indices</span><span class="p">,</span> <span class="n">neigh_indices</span><span class="p">,</span> <span class="n">neigh_coords</span><span class="p">,</span> <span class="n">dists</span> <span class="o">=</span> <span class="n">nn_data</span>

        <span class="c1"># sort radii</span>
        <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">all_radii</span><span class="p">)</span>
        <span class="n">sorted_sites</span> <span class="o">=</span> <span class="n">site_indices</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>

        <span class="c1"># get first instance of each atom</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">radii_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">all_radii_types</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)):</span>
            <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sorted_sites</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">radii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_radii</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">[</span><span class="n">first_index</span><span class="p">]]</span>
            <span class="n">radii_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_radii_types</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">[</span><span class="n">first_index</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">radii</span><span class="p">,</span> <span class="n">radii_types</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_feature_surface_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Calculates the distance from the average coordinates to the surface grid</span>
<span class="sd">        points for each feature node.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the minimum and average distance from each irreducible features</span>
        <span class="c1"># fractional coordinate to its edges. This is often different from the</span>
        <span class="c1"># original basins as we may combine some of them.</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span>

        <span class="c1"># collect frac coords and map basin labels to features</span>
        <span class="n">frac_coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">average_frac_coords</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
        <span class="n">feature_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_maxima_frac</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
            <span class="n">feature_map</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">basins</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_idx</span>

        <span class="c1"># get feature edges</span>
        <span class="n">neighbor_transforms</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">point_neighbor_transforms</span>

        <span class="n">edge_mask</span> <span class="o">=</span> <span class="n">get_feature_edges</span><span class="p">(</span>
            <span class="n">labeled_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span>
            <span class="n">feature_map</span><span class="o">=</span><span class="n">feature_map</span><span class="p">,</span>
            <span class="n">neighbor_transforms</span><span class="o">=</span><span class="n">neighbor_transforms</span><span class="p">,</span>
            <span class="n">vacuum_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">vacuum_mask</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># calculate the minimum and average distance to each features surface</span>
        <span class="n">min_dists</span><span class="p">,</span> <span class="n">avg_dists</span> <span class="o">=</span> <span class="n">get_min_avg_feat_surface_dists</span><span class="p">(</span>
            <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span>
            <span class="n">feature_map</span><span class="o">=</span><span class="n">feature_map</span><span class="p">,</span>
            <span class="n">frac_coords</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">frac_coords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
            <span class="n">edge_mask</span><span class="o">=</span><span class="n">edge_mask</span><span class="p">,</span>
            <span class="n">matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
            <span class="n">max_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">abc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># set surface distances</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">avg_dist</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">min_dists</span><span class="p">,</span> <span class="n">avg_dists</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">_min_surface_dist</span> <span class="o">=</span> <span class="n">min_dist</span>
            <span class="n">node</span><span class="o">.</span><span class="n">_avg_surface_dist</span> <span class="o">=</span> <span class="n">avg_dist</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Read Methods</span>
    <span class="c1">###########################################################################</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_vasp</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CHGCAR&quot;</span><span class="p">,</span>
        <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ELFCAR&quot;</span><span class="p">,</span>
        <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an ElfLabeler class object from VASP files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        charge_filename : Path | str, optional</span>
<span class="sd">            The path to the CHGCAR like file that will be used for summing charge.</span>
<span class="sd">            The default is &quot;CHGCAR&quot;.</span>
<span class="sd">        reference_filename : Path | str</span>
<span class="sd">            The path to ELFCAR like file that will be used for partitioning.</span>
<span class="sd">            If None, the charge file will be used for partitioning.</span>
<span class="sd">        total_only: bool</span>
<span class="sd">            If true, only the first set of data in the file will be read. This</span>
<span class="sd">            increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">            not used.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to pass to the Labeler class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            An ElfLabeler class object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This is just a wrapper of the Bader class to update the default to</span>
        <span class="c1"># load the ELFCAR</span>
        <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Write Methods</span>
    <span class="c1">###########################################################################</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_bifurcation_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Writes the BifurcationPlot to an html file. This is just a shortcut for</span>
<span class="sd">        ElfLabeler.bifurcation_plot.write_html.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str | Path</span>
<span class="sd">            The Path to write the plot to. &#39;html&#39; will be appended if it is not</span>
<span class="sd">            present in the path.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_plot</span>
        <span class="c1"># make sure path is a Path object</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="c1"># add .html if filename doesn&#39;t include it</span>
        <span class="n">filename_html</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.html&quot;</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="n">filename_html</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_feature_basins</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
        <span class="n">include_dummy_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For a give list of node keys, writes the bader basins associated with</span>
<span class="sd">        each.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature_indices : list[int]</span>
<span class="sd">            Which features to write basin volumes for.</span>
<span class="sd">        directory : str | Path, optional</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        include_dummy_atoms : bool, optional</span>
<span class="sd">            Whether or not to add dummy files to the structure. The default is False.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="c1"># get structure</span>
        <span class="k">if</span> <span class="n">include_dummy_atoms</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
            <span class="n">basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
            <span class="c1"># get mask where this feature is NOT</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basins</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
            <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
                <span class="n">structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_f</span><span class="si">{</span><span class="n">feat_idx</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># write file</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_feature_basins_sum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
        <span class="n">include_dummy_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For a give list of node keys, writes the union of the bader basins</span>
<span class="sd">        associated with each.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature_indices : list[int]</span>
<span class="sd">            Which features to include in the volume.</span>
<span class="sd">        directory : str | Path, optional</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        include_dummy_atoms : bool, optional</span>
<span class="sd">            Whether or not to add dummy files to the structure. The default is False.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="c1"># get structure</span>
        <span class="k">if</span> <span class="n">include_dummy_atoms</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="c1"># get all basin indices to include</span>
        <span class="n">basin_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
            <span class="n">basin_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">])</span>

        <span class="c1"># get mask where features are not</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basin_list</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_fsum&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_all_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the bader basins associated with all features</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            See :meth:`write_feature_basins`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins</span><span class="p">(</span>
            <span class="n">feature_indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_features_by_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">included_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span><span class="p">],</span>
        <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the bader basins associated with all features of the selected type</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        included_types : list[FeatureType]</span>
<span class="sd">            The types of features to include, e.g. metallic, lone-pair, etc.</span>
<span class="sd">        prefix_override : str</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is True.</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            See :meth:`write_feature_basins`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>
        <span class="k">for</span> <span class="n">feature_type</span> <span class="ow">in</span> <span class="n">included_types</span><span class="p">:</span>
            <span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="p">(</span><span class="n">feature_type</span><span class="p">)</span>
            <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">([</span><span class="n">feature_type</span><span class="p">])</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_override</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">feature_type</span><span class="o">.</span><span class="n">dummy_species</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins_sum</span><span class="p">(</span>
                <span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span><span class="p">,</span>
                <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># rename to remove fsum</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_fsum&quot;</span><span class="p">,</span>
                <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_features_by_type_sum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">included_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span><span class="p">],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the union of the bader basins associated with all features of the</span>
<span class="sd">        selected type</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            See :meth:`write_feature_basins_sum`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_types</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins_sum</span><span class="p">(</span><span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span>
        <span class="n">use_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">splitting_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="s2">&quot;pauling&quot;</span><span class="p">,</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span> <span class="s2">&quot;nearest&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets a dictionary summary of the ElfLabeler analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        potcar_path : Path | str, optional</span>
<span class="sd">            The Path to a POTCAR file. This must be provided for oxidation states</span>
<span class="sd">            to be calculated, and they will be None otherwise. The default is &quot;POTCAR&quot;.</span>
<span class="sd">        use_json : bool, optional</span>
<span class="sd">            Convert all entries to JSONable data types. The default is True.</span>
<span class="sd">        splitting_method : Literal[&quot;equal&quot;, &quot;pauling&quot;, &quot;dist&quot;, &quot;weighted_dist&quot;, &quot;nearest&quot;], optional</span>
<span class="sd">            See :meth:`write_feature_basins`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A summary of the ElfLabeler analysis in dictionary form.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># collect method kwargs</span>
        <span class="n">method_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;splitting_method&quot;</span><span class="p">:</span> <span class="n">splitting_method</span><span class="p">,</span>
            <span class="s2">&quot;crystalnn_kwargs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystalnn_kwargs</span><span class="p">,</span>
            <span class="s2">&quot;ignore_low_pseudopotentials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_low_pseudopotentials</span><span class="p">,</span>
            <span class="s2">&quot;shared_shell_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_shell_ratio</span><span class="p">,</span>
            <span class="s2">&quot;covalent_molecule_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">covalent_molecule_ratio</span><span class="p">,</span>
            <span class="s2">&quot;min_covalent_charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">,</span>
            <span class="s2">&quot;min_covalent_angle&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_angle</span><span class="p">,</span>
            <span class="s2">&quot;min_electride_elf_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_elf_value</span><span class="p">,</span>
            <span class="s2">&quot;min_electride_depth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_depth</span><span class="p">,</span>
            <span class="s2">&quot;min_electride_charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_charge</span><span class="p">,</span>
            <span class="s2">&quot;min_electride_volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_volume</span><span class="p">,</span>
            <span class="s2">&quot;min_electride_dist_beyond_atom&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_dist_beyond_atom</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;method_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method_kwargs</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;spin_system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_system</span>

        <span class="c1"># only try to calculate oxidation state if this was not a half spin system</span>
        <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_system</span> <span class="o">==</span> <span class="s2">&quot;total&quot;</span> <span class="ow">and</span> <span class="n">potcar_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">oxidation_states</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
                    <span class="n">potcar_path</span><span class="o">=</span><span class="n">potcar_path</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">oxidation_states_e</span><span class="p">,</span> <span class="n">charges_e</span><span class="p">,</span> <span class="n">volumes_e</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
                    <span class="n">potcar_path</span><span class="o">=</span><span class="n">potcar_path</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">oxidation_states</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">oxidation_states_e</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">charges_e</span><span class="p">,</span> <span class="n">volumes_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oxidation_states</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">oxidation_states</span> <span class="o">=</span> <span class="n">oxidation_states</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">oxidation_states_e</span> <span class="o">=</span> <span class="n">oxidation_states_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxidation_states</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxidation_states_e</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;charges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">charges</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;charges_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">charges_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;volumes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volumes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;volumes_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volumes_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="c1"># add objects that can convert to json</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;labeled_structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;electride_structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bifurcation_graph&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">use_json</span><span class="p">:</span>
                <span class="n">result_obj</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
            <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

        <span class="c1"># add objects that are arrays</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;atom_elf_radii&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_elf_radii_types&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_elf_radii_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_elf_radii_types_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_max_values_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_max_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_min_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_charges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_volumes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_coord_nums&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_coord_nums_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_min_surface_dists&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_avg_surface_dists&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_json</span> <span class="ow">and</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result_obj</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

        <span class="c1"># add objects that are lists with arrays</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;feature_coord_dists&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_coord_atoms_dists_e&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_json</span> <span class="ow">and</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result_obj</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_obj</span><span class="p">]</span>
            <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

        <span class="c1"># add other objects that are already jsonable</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;nelectrides&quot;</span><span class="p">,</span>
            <span class="s2">&quot;electride_formula&quot;</span><span class="p">,</span>
            <span class="s2">&quot;electrides_per_formula&quot;</span><span class="p">,</span>
            <span class="s2">&quot;electrides_per_reduced_formula&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_types&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_coord_atoms&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_coord_atoms_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_feature_indices_e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;total_electron_number&quot;</span><span class="p">,</span>
            <span class="s2">&quot;total_volume&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vacuum_charge&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vacuum_volume&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a JSON string representation of the results, typically for writing</span>
<span class="sd">        results to file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for the to_dict method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A JSON string representation of the BadELF results.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;elf_labeler.json&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes results of the analysis to file in a JSON format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : Path | str, optional</span>
<span class="sd">            The Path to write the results to. The default is &quot;elf_labeler.json&quot;.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            keyword arguments for the to_dict method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Core Graph Construction</span>
    <span class="c1">###########################################################################</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_bifurcation_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        This constructs a BifurcationGraph class and labels each irreducible feature</span>
<span class="sd">        as a chemical feature. This is the core of the method and is not meant to</span>
<span class="sd">        be called directly.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># run bader for nice looking logging purposes</span>
        <span class="c1"># NOTE: I call a property rather than run_bader/run_atom_assignment to</span>
        <span class="c1"># avoid repeat calcs if we&#39;ve already run</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">atom_labels</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Beginning ELF Analysis&quot;</span><span class="p">)</span>

        <span class="c1"># get an initial graph connecting bifurcations and final basins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_bifurcation_graph</span><span class="p">()</span>

        <span class="c1"># Now we have a graph with information associated with each basin. We want</span>
        <span class="c1"># to label each node. First, we label cores as they are the simplest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_cores</span><span class="p">()</span>

        <span class="c1"># Next, we mark shells. This step distinguishes ionic and covalent</span>
        <span class="c1"># features, the most ambiguous step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_shells</span><span class="p">()</span>

        <span class="c1"># Next we label covalent bonds. These must lie along an atomic bond and</span>
        <span class="c1"># have a reasonably large charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_covalent</span><span class="p">()</span>

        <span class="c1"># Next we mark lone pairs. These split off from covalent bonds or rarely</span>
        <span class="c1"># from atomic shells (e.g. SnO)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_lonepairs</span><span class="p">()</span>

        <span class="c1"># get atomic radii before checking for metal/bare.</span>
        <span class="c1"># NOTE: This intentionally may underestimates radii in metallic systems.</span>
        <span class="c1"># For metal systems, we would treat metal maxima similar to covalent</span>
        <span class="c1"># bonds. For electrides, we would treat maxima as part of a separate</span>
        <span class="c1"># &quot;electride atom&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Calculating atomic radii&quot;</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">site_indices</span><span class="p">,</span>
            <span class="n">neigh_indices</span><span class="p">,</span>
            <span class="n">neigh_coords</span><span class="p">,</span>
            <span class="n">radii</span><span class="p">,</span>
            <span class="n">dists</span><span class="p">,</span>
            <span class="n">bond_types</span><span class="p">,</span>
            <span class="n">plane_points</span><span class="p">,</span>
            <span class="n">plane_vectors</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_nn_atom_elf_radii</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii</span> <span class="o">=</span> <span class="n">radii</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_elf_radii_types</span> <span class="o">=</span> <span class="n">bond_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nearest_neighbor_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">site_indices</span><span class="p">,</span> <span class="n">neigh_indices</span><span class="p">,</span> <span class="n">neigh_coords</span><span class="p">,</span> <span class="n">dists</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_nn_planes</span> <span class="o">=</span> <span class="p">(</span><span class="n">plane_points</span><span class="p">,</span> <span class="n">plane_vectors</span><span class="p">)</span>

        <span class="c1"># Next we mark our metallic/bare electrons. These currently have a set</span>
        <span class="c1"># of rather arbitrary cutoffs to distinguish between them. In the future</span>
        <span class="c1"># I would like to perform a comprehensive study.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_metallic_or_bare</span><span class="p">()</span>

        <span class="c1"># BUGFIX: The atomic radii are somewhat dependent on if we consider a</span>
        <span class="c1"># feature to be metallic or a qausi-atom. We first calculate the radii</span>
        <span class="c1"># assuming electride atoms to allow for the best chance of a feature getting</span>
        <span class="c1"># through the &quot;dist_beyond_atom&quot; cutoff. Then we recalculate and relabel</span>
        <span class="c1"># so that metallic systems have the proper label</span>
        <span class="c1"># Recalculate radii with our updated markers</span>
        <span class="c1"># logging.info(&quot;Re-calculating atomic radii&quot;)</span>
        <span class="c1"># self._atom_elf_radii = None</span>
        <span class="c1"># self._atom_elf_radii_types = None</span>
        <span class="c1"># self._atom_nn_elf_radii, self._atom_nn_elf_radii_types = self._get_nn_atom_elf_radii(self.structure, self.nearest_neighbor_data)</span>

        <span class="c1"># # Re-mark metallic/electrides</span>
        <span class="c1"># self._mark_metallic_or_bare()</span>

        <span class="c1"># In some cases, the user may not have used a pseudopotential with enough core electrons.</span>
        <span class="c1"># This can result in an atom having no assigned core/shell, which will</span>
        <span class="c1"># result in nonsense later. We check for this here and throw an error</span>
        <span class="n">assigned_atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">get_feature_nodes</span><span class="p">(</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">atomic_types</span><span class="p">):</span>
            <span class="n">assigned_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">nearest_atom</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">assigned_atoms</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_low_pseudopotentials</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;At least one atom was not assigned a zero-flux basin. This typically results&quot;</span>
                <span class="s2">&quot;from pseudo-potentials (PPs) with only valence electrons (e.g. the defaults for Al, Si, B in VASP 5.X.X).&quot;</span>
                <span class="s2">&quot;Try using PPs with more valence electrons such as VASP&#39;s GW potentials&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Finally, we ensure that all nodes have an assignment</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">unassigned_nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;At least one ELF feature was not assigned. This is a bug!!! Please report it to our github:&quot;</span>
                <span class="s2">&quot;https://github.com/SWeav02/baderkit/issues&quot;</span>
            <span class="p">)</span>

        <span class="c1"># calculate feature surface distances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_feature_surface_dists</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finished labeling ELF&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_bifurcation_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Creates an initial unlabeled bifurcation graph using information from</span>
<span class="sd">        Bader analysis of the ELF.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bifurcation_graph</span> <span class="o">=</span> <span class="n">BifurcationGraph</span><span class="o">.</span><span class="n">from_labeler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># Core feature labeling methods</span>
    <span class="c1">###############################################################################</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_cores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marking atomic shells&quot;</span><span class="p">)</span>
        <span class="c1"># cores are reducible domains that contain an atom. They should be within</span>
        <span class="c1"># one voxel of the atom. We must check for this as it is possible for</span>
        <span class="c1"># a different type of basin to contain the atom if too few valence electrons</span>
        <span class="c1"># are in the pseudopotential</span>
        <span class="n">max_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">max_point_dist</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">unassigned_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">domain_subtype</span> <span class="o">==</span> <span class="n">DomainSubtype</span><span class="o">.</span><span class="n">irreducible_cage</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">atom_distance</span> <span class="o">&lt;=</span> <span class="n">max_dist</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">shell</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_shells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># shells are reducible domains that surround exactly one atom.</span>
        <span class="c1"># In a vacuum, an atoms shells are spherical due to symmetry. In a</span>
        <span class="c1"># molecule/solid they will warp due to interactions with neighboring</span>
        <span class="c1"># atoms. If a neighbor has a strong enough attraction, the shell will</span>
        <span class="c1"># break into multiple child domains (covalent/lone-pairs). If its even</span>
        <span class="c1"># stronger, the shell will move fully to the neighbor (ionic bond) and</span>
        <span class="c1"># form a shell there.</span>

        <span class="c1"># Our criteria for a shell domain is as follows:</span>
        <span class="c1"># 1. Surrounds 1 atom</span>
        <span class="c1"># 2. Is 0D (finite)</span>
        <span class="c1"># 3. Exists as a shell in a much larger range than as individual child</span>
        <span class="c1"># domains</span>

        <span class="c1"># First, we label any nodes that surround 1 atom but don&#39;t have a maximum</span>
        <span class="c1"># at the atoms nucleus. This often happens for particularly shallow shells</span>
        <span class="c1"># if they are combined when our graph is first generated</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">unassigned_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="s2">&quot;shell&quot;</span>

        <span class="c1"># Now we label shells that may be slightly deeper. We compare the range</span>
        <span class="c1"># where the domain surrounds 1 atom to the range itself or any of its children</span>
        <span class="c1"># exist. The ratio is compared to our cutoff</span>

        <span class="n">shell_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">reducible_nodes</span><span class="p">:</span>
            <span class="c1"># skip nodes that don&#39;t surround a single atom or have a dimensionality above 0</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_infinite</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># skip nodes that have children that also contain the single atom</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">]):</span>
                <span class="k">continue</span>

            <span class="c1"># Get the depth of the domain</span>
            <span class="n">shared_shell_depth</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">depth</span>

            <span class="c1"># Get the total range this node or its children exist</span>
            <span class="n">max_elf</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">max_value</span> <span class="o">&gt;</span> <span class="n">max_elf</span><span class="p">:</span>
                    <span class="n">max_elf</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">max_value</span>
            <span class="n">total_depth</span> <span class="o">=</span> <span class="n">max_elf</span> <span class="o">-</span> <span class="n">node</span><span class="o">.</span><span class="n">min_value</span>

            <span class="n">ratio</span> <span class="o">=</span> <span class="n">shared_shell_depth</span> <span class="o">/</span> <span class="n">total_depth</span>
            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_shell_ratio</span><span class="p">:</span>
                <span class="n">shell_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>

        <span class="c1"># mark nodes as shells</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">shell_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_shells</span><span class="p">:</span>
                <span class="c1"># convert to an irreducible node</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">make_irreducible</span><span class="p">()</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="s2">&quot;shell&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="o">.</span><span class="n">is_reducible</span><span class="p">:</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;shell&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_covalent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes in a bifurcation graph and labels valence features that</span>
<span class="sd">        are obviously metallic or covalent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marking covalent features&quot;</span><span class="p">)</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span>

        <span class="c1"># get frac coords of unassigned nodes</span>
        <span class="n">valence_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">valence_frac</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">unassigned_nodes</span><span class="p">:</span>
            <span class="n">valence_frac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">average_frac_coords</span><span class="p">)</span>
            <span class="n">valence_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># Convert our cutoff angle to radians</span>
        <span class="n">min_covalent_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_angle</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>

        <span class="c1"># get our atom frac coords</span>
        <span class="n">atom_frac_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span>
        <span class="n">atom_cart_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">cart_coords</span>

        <span class="c1"># check which nodes are within our tolerance</span>
        <span class="c1"># if/then is to avoid numba disliking empty lists</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valence_frac</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nodes_in_tolerance</span><span class="p">,</span> <span class="n">atom_neighs</span> <span class="o">=</span> <span class="n">check_all_covalent</span><span class="p">(</span>
                <span class="n">valence_frac</span><span class="p">,</span>
                <span class="n">atom_frac_coords</span><span class="p">,</span>
                <span class="n">atom_cart_coords</span><span class="p">,</span>
                <span class="n">frac2cart</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
                <span class="n">min_covalent_angle</span><span class="o">=</span><span class="n">min_covalent_angle</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes_in_tolerance</span><span class="p">,</span> <span class="n">atom_neighs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">in_tolerance</span><span class="p">,</span> <span class="p">(</span><span class="n">atom0</span><span class="p">,</span> <span class="n">atom1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">valence_nodes</span><span class="p">,</span> <span class="n">nodes_in_tolerance</span><span class="p">,</span> <span class="n">atom_neighs</span>
        <span class="p">):</span>
            <span class="c1"># skip nodes that aren&#39;t within our angle tolerance</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">in_tolerance</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># set backup</span>
            <span class="n">contained_atoms</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">ancestors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contained_atoms</span>
            <span class="k">if</span> <span class="n">atom0</span> <span class="ow">in</span> <span class="n">contained_atoms</span> <span class="ow">and</span> <span class="n">atom1</span> <span class="ow">in</span> <span class="n">contained_atoms</span><span class="p">:</span>
                <span class="n">is_covalent</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">is_covalent</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># could happen if there are multiple roots</span>

            <span class="c1"># Sometimes a lone pair happens to align well with an atom that</span>
            <span class="c1"># is not part of our covalent system (e.g. CaC2). Similar to shells,</span>
            <span class="c1"># the range of values containing both atoms should be comparable to</span>
            <span class="c1"># the rane of values containing at least one of them.</span>
            <span class="c1"># POSSIBLE BUG: Atoms with translational symmetry might be counted</span>
            <span class="c1"># as part of multiple covalent systems and break this in small</span>
            <span class="c1"># unit cells. This would require knowing which atom image is contained</span>
            <span class="c1"># which we currently don&#39;t track and would require a large rework</span>

            <span class="c1"># find range of values containing at least one and both of the atoms</span>
            <span class="n">one_atom</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">both_atoms</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">ancestors</span><span class="p">:</span>
                <span class="n">contained_atoms</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">contained_atoms</span>
                <span class="k">if</span> <span class="n">atom0</span> <span class="ow">in</span> <span class="n">contained_atoms</span> <span class="ow">or</span> <span class="n">atom1</span> <span class="ow">in</span> <span class="n">contained_atoms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">one_atom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">one_atom</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">max_value</span>
                <span class="k">if</span> <span class="n">atom0</span> <span class="ow">in</span> <span class="n">contained_atoms</span> <span class="ow">and</span> <span class="n">atom1</span> <span class="ow">in</span> <span class="n">contained_atoms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">both_atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">both_atoms</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">max_value</span>
                        <span class="k">break</span>

            <span class="n">is_covalent</span> <span class="o">=</span> <span class="p">(</span><span class="n">both_atoms</span> <span class="o">/</span> <span class="n">one_atom</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covalent_molecule_ratio</span>

            <span class="c1"># check that we truly only have two nearest neighbors</span>
            <span class="k">if</span> <span class="n">is_covalent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">coord_number</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">is_covalent</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">is_covalent</span><span class="p">:</span>
                <span class="c1"># label as covalent or metallic covalent depending on the species&#39;</span>
                <span class="c1"># type and charge</span>
                <span class="n">species1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">atom0</span><span class="p">)]</span><span class="o">.</span><span class="n">specie</span>
                <span class="n">species2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)]</span><span class="o">.</span><span class="n">specie</span>
                <span class="k">if</span> <span class="n">species1</span><span class="o">.</span><span class="n">is_metal</span> <span class="ow">or</span> <span class="n">species2</span><span class="o">.</span><span class="n">is_metal</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">:</span>
                        <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">covalent_metallic</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># this is a metal bond but it has very low charge</span>
                        <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">shallow_covalent_metallic</span>
                    <span class="c1"># we also go ahead and set the neighboring atoms to avoid some</span>
                    <span class="c1"># CrystalNN calculations</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">_coord_indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">atom0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">:</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">covalent</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">_coord_indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">atom0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">atom1</span><span class="p">)]</span>

        <span class="c1"># note we&#39;ve labeled our covalent features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labeled_covalent</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_lonepairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marking lone-pair features&quot;</span><span class="p">)</span>
        <span class="c1"># lone-pairs separate off from covalent bonds or rarely from an ionic</span>
        <span class="c1"># core/shell. When breaking from covalent bonds, the lone-pair will only</span>
        <span class="c1"># have one nearest neighbor in the molecule. When breaking off of</span>
        <span class="c1"># an ionic core/shell, the lone-pair will at some point be part of a</span>
        <span class="c1"># domain surrounding a single atom.</span>

        <span class="c1"># POSSIBLE BUG:</span>
        <span class="c1"># In small cells, if a feature neighbors the same atoms at different</span>
        <span class="c1"># translations and both belong to the same molecule/domain, it may</span>
        <span class="c1"># be mislabeled as a lone-pair instead of a metal bond</span>
        <span class="n">assigned_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="n">FeatureType</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span>
                <span class="n">FeatureType</span><span class="o">.</span><span class="n">shallow_covalent_metallic</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="c1"># NOTE: exclude shallow covalent metal features in case these end up being</span>
                <span class="c1"># misassigned deep shells. Not sure if this is necessary</span>
                <span class="n">assigned_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">sorted_reducible_nodes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="c1"># skip nodes that don&#39;t contain atoms</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># if none of this nodes children have an assignment, they are mislabeled</span>
            <span class="c1"># shells</span>
            <span class="n">all_labeled</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">none_labeled</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">some_covalent</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">some_atom</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">is_reducible</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># note if we have a covalent feature</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">FeatureType</span><span class="o">.</span><span class="n">covalent</span><span class="p">,</span>
                    <span class="n">FeatureType</span><span class="o">.</span><span class="n">covalent_metallic</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">some_covalent</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># note if we have some shell feature</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">atomic_types</span><span class="p">:</span>
                    <span class="n">some_atom</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># If this node is assigned, note that not all are unlabeled</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">assigned_nodes</span><span class="p">:</span>
                    <span class="n">none_labeled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># If this node isn&#39;t assigned, note not all are labeled</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">all_labeled</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># skip if all children are already labeled</span>
            <span class="k">if</span> <span class="n">all_labeled</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># if we have exactly one atom in this domain, we may have an atom</span>
            <span class="c1"># that&#39;s ionically bonded with a lone-pair (e.g. SnO). We may also</span>
            <span class="c1"># have mislabeled a shell earlier due to a particularly deep feature</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">:</span>
                <span class="c1"># if none are labeled these are mislabeled shells</span>
                <span class="k">if</span> <span class="n">none_labeled</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                        <span class="n">child</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">deep_shell</span>
                        <span class="n">assigned_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                <span class="c1"># if some are atomic and none are covalent, we have ionic</span>
                <span class="c1"># lone-pairs or small metallic features. We check that they</span>
                <span class="c1"># have reasonable charge</span>
                <span class="k">elif</span> <span class="n">some_atom</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">some_covalent</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">is_reducible</span> <span class="ow">or</span> <span class="n">child</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">assigned_nodes</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">:</span>
                            <span class="n">child</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">lone_pair</span>
                            <span class="n">assigned_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                <span class="c1"># otherwise these features are some form of metallic and we just</span>
                <span class="c1"># continue</span>
                <span class="k">continue</span>

            <span class="c1"># if nothing is labeled and we surround more than one atom, we have</span>
            <span class="c1"># a group of metal features. We mark them as assigned and continue</span>
            <span class="k">if</span> <span class="n">none_labeled</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                    <span class="n">assigned_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Any other lone-pairs must come along with a covalent bond. If we</span>
            <span class="c1"># don&#39;t have one we continue</span>
            <span class="c1"># NOTE: Should I mark these as checked?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">some_covalent</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># otherwise, check each unassigned node to see if it has exactly</span>
            <span class="c1"># one neighbor in this domain</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">deep_children</span><span class="p">:</span>
                <span class="c1"># skip reducible nodes and nodes with assignments</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">is_reducible</span> <span class="ow">or</span> <span class="n">child</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">assigned_nodes</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># check how many neighs are in this domain</span>
                <span class="n">neighs_in_domain</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">atom_idx</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">coord_indices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">atom_idx</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">contained_atoms</span><span class="p">:</span>
                        <span class="n">neighs_in_domain</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">neighs_in_domain</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="c1"># if theres more than one neighbor in the molecule, continue</span>
                <span class="k">if</span> <span class="n">neighs_in_domain</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># if we have a node with reasonable charge, mark it at a lone-pair</span>
                <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">:</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">lone_pair</span>
                    <span class="n">assigned_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                    <span class="c1"># reset coord env so that it gets calculated as 1</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">_coord_indices</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_metallic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marking metallic features&quot;</span><span class="p">)</span>
        <span class="c1"># we mark metallic features simply based on their depth</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">unassigned_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_metal_depth</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">metallic</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_mark_metallic_or_bare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labeled_multi</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marking multi-centered and bare electron features&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Re-marking multi-centered and bare electron features&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labeled_multi</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># The remaining features are various types of non-nuclear attractors.</span>
        <span class="c1"># We separate them into metallic or &quot;bare electrons&quot; based on a series</span>
        <span class="c1"># of cutoffs</span>

        <span class="c1"># first we need to calculate how far each feature is beyond nearby</span>
        <span class="c1"># atom radii</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">:</span>
            <span class="c1"># get dists to atoms</span>
            <span class="n">atom_dists</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">atom_dists</span>
            <span class="c1"># get atom radii</span>
            <span class="n">atom_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii</span>
            <span class="c1"># get the lowest distance beyond an atom</span>
            <span class="n">dist_beyond_atoms</span> <span class="o">=</span> <span class="n">atom_dists</span> <span class="o">-</span> <span class="n">atom_radii</span>
            <span class="n">node</span><span class="o">.</span><span class="n">_nearest_atom_sphere</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist_beyond_atoms</span><span class="p">)</span>
            <span class="n">node</span><span class="o">.</span><span class="n">_dist_beyond_atom</span> <span class="o">=</span> <span class="n">dist_beyond_atoms</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="c1"># NOTE: These are very likely to change in the future</span>
        <span class="n">conditions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_elf_value</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_depth</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_charge</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_volume</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_dist_beyond_atom</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_graph</span><span class="o">.</span><span class="n">irreducible_nodes</span><span class="p">:</span>
            <span class="c1"># skip nodes that aren&#39;t metallic/bare/unlabeled</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">FeatureType</span><span class="o">.</span><span class="n">metallic</span><span class="p">,</span>
                <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_electron</span><span class="p">,</span>
                <span class="n">FeatureType</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">condition_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">max_value</span><span class="p">,</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">depth_to_infinite</span><span class="p">,</span>  <span class="c1"># Note we use the depth to an infinite connection rather than true depth</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">dist_beyond_atom</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">condition_test</span> <span class="o">&gt;</span> <span class="n">conditions</span><span class="p">):</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_electron</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">multi_centered</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_elf_radii</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The radius of each atom calculated from the ELF using the closest
neighboring atom in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_elf_radii_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The radius of each atom and electride site calculated from the ELF
using the closest neighboring atom/electride in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_elf_radii_types</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of radius of each elf radius. Covalent indicates that the
bond crosses through some covalent or metallic region, and the radius
is placed at the maximum in the ELF in this region. Ionic indicates
that the bond does not pass through the covalent/metallic region and
the radius is placed at the minimum between the two atoms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_elf_radii_types_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_elf_radii_types_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of radius of each atom/electride elf radius. Covalent indicates that the
bond crosses through some covalent or metallic region, and the radius
is placed at the maximum in the ELF in this region. Ionic indicates
that the bond does not pass through the covalent/metallic region and
the radius is placed at the minimum between the two atoms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_feature_indices_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_feature_indices_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_feature_indices_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The feature indices assigned to each atom/electride in the electride
structure. Features assigned to multiple atoms are not included.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_max_values_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_max_values_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_max_values_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum value that each atom has an existing feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_nn_elf_radii</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elf radii for each atom and its neighboring atoms in the same
order as the nearest_neighbor_data property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_nn_elf_radii_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The elf radii for each atom/electride and its neighboring atoms in the same
order as the nearest_neighbor_data_e property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_nn_elf_radii_types</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of radius for each atom and its neighboring atoms in the same
order as the nearest_neighbor_data property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_nn_elf_radii_types_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.atom_nn_elf_radii_types_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of radius for each atom/electride and its neighboring atoms in the same
order as the nearest_neighbor_data property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bifurcation_graph</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_graph" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.labelers.bifurcation_graph.BifurcationGraph">BifurcationGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A BifurcationGraph class representing features and bifurcations in the
ELF.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bifurcation_plot</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.bifurcation_plot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A plotly graph object representing the bifurcation graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electride_formula</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_formula" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representation of the electride formula, rounding partial charge
to the nearest integer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electride_structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electride_structure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The system's structure including dummy atoms representing electride
sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electrides_per_formula</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_formula" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of electride electrons for the full structure formula.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_reduced_formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electrides_per_reduced_formula</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.electrides_per_reduced_formula" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of electrons in the reduced formula of the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_average_frac_coords" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_average_frac_coords</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_average_frac_coords" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The average fractional coordinates of the Bader basin maxima for each
feature. Note that it is possible for this coordinate to be outside
of the feature, particularly for atom shells which form sphere-like
shapes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_avg_surface_dists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_avg_surface_dists</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_avg_surface_dists" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The average distance from the average frac coord of each feature to the
partitioning surface.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_basins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_basins</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_basins" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Bader basins associated with each feature. For features with
multiple basins, the basins are separated by very shallow minima
and are better understood as a single feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_charges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_charges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_charges" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge associated with each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_atoms</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The atoms coordinated with each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_dists_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_atoms_dists_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_dists_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to each coordinated atom/electride from each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_atoms_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_atoms_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinated atoms to each feature, including electrides as quasi-atoms</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_dists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_dists</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_dists" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance to each coordinated atom from each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_nums</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of atoms coordinated with each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_coord_nums_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_coord_nums_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of coordinated atoms for each featuree, including
electrides as quasi-atoms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_frac_coords" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_frac_coords</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_frac_coords" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fractional coordinates of the maxima in each Bader basin
for each feature in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_max_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_max_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_max_values" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum value at which each feature exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_surface_dists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_min_surface_dists</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_surface_dists" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum distance from the average frac coord of each feature to the
partitioning surface.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_min_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_min_values" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum value at which each feature exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_types</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_types" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of each ELF feature in the system.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_volumes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The volume associated with each feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.labeled_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">labeled_structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.labeled_structure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The system's structure including dummy atoms representing electride
sites and covalent/metallic bonds. Features unique to the spin-up/spin-down
systems will have xu or xd appended to the species name respectively.
Features that exist in both will have nothing appended.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nearest_neighbor_data</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nearest neighbor data for the atoms in the system represented as
a tuple of arrays. The arrays represent, in order, the central
atoms index, its neighbors index, the fractional coordinates of the
neighbor, and the distance between the two sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nearest_neighbor_data_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nearest_neighbor_data_e" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nearest neighbor data for the atoms AND the electrides
in the system represented as a tuple of arrays. The arrays represent,
in order, the central atoms index, its neighbors index, the fractional
coordinates of the neighbor, and the distance between the two sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.nelectrides" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nelectrides</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.nelectrides" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of electride sites in the structure</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.num_vacuum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_vacuum</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.num_vacuum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of vacuum points in the array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.structure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PyMatGen Structure representing the system.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_electron_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_electron_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_electron_number" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total number of electrons in the system calculated from the
atom charges and vacuum charge. If this does not match the true
total electron number within reasonable floating point error,
there is a major problem.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.total_volume" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total volume integrated in the system. This should match the
volume of the structure. If it does not there may be a serious problem.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_charge</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_charge" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge assigned to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_mask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_mask</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_mask" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mask representing the voxels that belong to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.vacuum_volume" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total volume assigned to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_indices_by_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">feature_types</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.feature_indices_by_type" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets a list of feature indices from a list of types of Features
(e.g. bare electron, metallic, covalent)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_types</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="baderkit.core.labelers.bifurcation_graph.FeatureType">FeatureType</span> | <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of feature types to find indices for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of feature indices corresponding to all feature types in the
provided list. These correspond to the order in which feature properties
(e.g. ElfLabeler.feature_charges) appear in.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">feature_indices_by_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Gets a list of feature indices from a list of types of Features</span>
<span class="sd">    (e.g. bare electron, metallic, covalent)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    feature_types : list[FeatureType | str]</span>
<span class="sd">        The list of feature types to find indices for.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NDArray</span>
<span class="sd">        A list of feature indices corresponding to all feature types in the</span>
<span class="sd">        provided list. These correspond to the order in which feature properties</span>
<span class="sd">        (e.g. ElfLabeler.feature_charges) appear in.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">)</span> <span class="k">if</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">feature_types</span><span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.from_vasp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="o">=</span><span class="s1">&#39;CHGCAR&#39;</span><span class="p">,</span> <span class="n">reference_filename</span><span class="o">=</span><span class="s1">&#39;ELFCAR&#39;</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.from_vasp" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates an ElfLabeler class object from VASP files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CHGCAR like file that will be used for summing charge.
The default is "CHGCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;CHGCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to ELFCAR like file that will be used for partitioning.
If None, the charge file will be used for partitioning.</p>
              </div>
            </td>
            <td>
                  <code>&#39;ELFCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, only the first set of data in the file will be read. This
increases speed and reduced memory usage as the other data is typically
not used.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Labeler class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="src.baderkit.core.labelers.elf_labeler.elf_labeler.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An ElfLabeler class object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_vasp</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CHGCAR&quot;</span><span class="p">,</span>
    <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ELFCAR&quot;</span><span class="p">,</span>
    <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an ElfLabeler class object from VASP files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_filename : Path | str, optional</span>
<span class="sd">        The path to the CHGCAR like file that will be used for summing charge.</span>
<span class="sd">        The default is &quot;CHGCAR&quot;.</span>
<span class="sd">    reference_filename : Path | str</span>
<span class="sd">        The path to ELFCAR like file that will be used for partitioning.</span>
<span class="sd">        If None, the charge file will be used for partitioning.</span>
<span class="sd">    total_only: bool</span>
<span class="sd">        If true, only the first set of data in the file will be read. This</span>
<span class="sd">        increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">        not used.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments to pass to the Labeler class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Self</span>
<span class="sd">        An ElfLabeler class object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This is just a wrapper of the Bader class to update the default to</span>
    <span class="c1"># load the ELFCAR</span>
    <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>
    <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_charges_and_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_charges_and_volumes</span><span class="p">(</span><span class="n">splitting_method</span><span class="o">=</span><span class="s1">&#39;weighted_dist&#39;</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_charges_and_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Assign charge from each feature to their associated atoms. For features
that have multiple neighbors (e.g. covalent bonds), several options
are provided for how to divide the charge to nearby neighbors.
If use_electrides is set to True, features with electride like character
will be treated as atoms and</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>splitting_method</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;equal&#39;, &#39;pauling&#39;, &#39;dist&#39;, &#39;weighted_dist&#39;, &#39;nearest&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used to divide charge and volume of shared features
betweeen their coordinating atoms.</p>
<pre><code>'weighted_dist' (default)
    Fraction increases with decreasing distance to each atom. The
    fraction is further weighted by the radius of each atom
    calculated from the ELF
'pauling'
    Fraction increases with decreasing pauling electronegativity.
    If an atom has no recorded EN a value of 2.2 is used which
    may be incorrect in many cases.
'equal'
    Each neighboring atom receives an equal fraction.
'dist'
    Fraction increases with decreasing distance to the center
    of each atom
'nearest'
    All charge is assigned to the features nearest atom.
</code></pre>
              </div>
            </td>
            <td>
                  <code>&#39;weighted_dist&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_electrides</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, features labeled as bare electrons will be treated as electride
atoms. They will receive partial charge from other shared features
and their charge/volume will be appended after the atoms'.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two arrays representing the charges and volumes respectively.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_charges_and_volumes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">splitting_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span> <span class="s2">&quot;pauling&quot;</span><span class="p">,</span> <span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="s2">&quot;nearest&quot;</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span>
    <span class="n">use_electrides</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign charge from each feature to their associated atoms. For features</span>
<span class="sd">    that have multiple neighbors (e.g. covalent bonds), several options</span>
<span class="sd">    are provided for how to divide the charge to nearby neighbors.</span>
<span class="sd">    If use_electrides is set to True, features with electride like character</span>
<span class="sd">    will be treated as atoms and</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    splitting_method : Literal[&quot;equal&quot;, &quot;pauling&quot;, &quot;dist&quot;, &quot;weighted_dist&quot;, &quot;nearest&quot;], optional</span>
<span class="sd">        The method used to divide charge and volume of shared features</span>
<span class="sd">        betweeen their coordinating atoms.</span>

<span class="sd">            &#39;weighted_dist&#39; (default)</span>
<span class="sd">                Fraction increases with decreasing distance to each atom. The</span>
<span class="sd">                fraction is further weighted by the radius of each atom</span>
<span class="sd">                calculated from the ELF</span>
<span class="sd">            &#39;pauling&#39;</span>
<span class="sd">                Fraction increases with decreasing pauling electronegativity.</span>
<span class="sd">                If an atom has no recorded EN a value of 2.2 is used which</span>
<span class="sd">                may be incorrect in many cases.</span>
<span class="sd">            &#39;equal&#39;</span>
<span class="sd">                Each neighboring atom receives an equal fraction.</span>
<span class="sd">            &#39;dist&#39;</span>
<span class="sd">                Fraction increases with decreasing distance to the center</span>
<span class="sd">                of each atom</span>
<span class="sd">            &#39;nearest&#39;</span>
<span class="sd">                All charge is assigned to the features nearest atom.</span>

<span class="sd">    use_electrides : bool, optional</span>
<span class="sd">        If True, features labeled as bare electrons will be treated as electride</span>
<span class="sd">        atoms. They will receive partial charge from other shared features</span>
<span class="sd">        and their charge/volume will be appended after the atoms&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[NDArray]</span>
<span class="sd">        Two arrays representing the charges and volumes respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

    <span class="c1"># create an array to store atom charges and volumes</span>
    <span class="n">atom_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">atom_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># if using pauling, get all electronegativities</span>
    <span class="k">if</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;pauling&quot;</span><span class="p">:</span>
        <span class="n">pauling_ens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">X</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">])</span>
        <span class="n">pauling_ens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">pauling_ens</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>

    <span class="n">electride_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">)):</span>
        <span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_volumes</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
            <span class="c1"># check if this is an electride feature</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                <span class="c1"># assign charge/volume to self</span>
                <span class="n">struc_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span> <span class="o">+</span> <span class="n">electride_num</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">struc_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">struc_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>
                <span class="n">electride_num</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="c1"># get coordination with electrides</span>
            <span class="n">coord_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># get coordination without electrides</span>
            <span class="n">coord_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span>
        <span class="c1"># get unique atoms and counts (correction for small cells)</span>
        <span class="n">unique_atoms</span><span class="p">,</span> <span class="n">unique_indices</span><span class="p">,</span> <span class="n">atom_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
            <span class="n">coord_atoms</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># This shouldn&#39;t happen, but could if CrystalNN failed</span>
            <span class="c1"># to find neighbors.</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No neighboring atoms found for feature with index </span><span class="si">{</span><span class="n">feature_idx</span><span class="si">}</span><span class="s2">. Feature assigned to nearest atom.&quot;</span>
            <span class="p">)</span>
            <span class="c1"># assign all charge/volume to the closest atom</span>
            <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">])</span>
            <span class="n">atom_charge</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
            <span class="n">atom_volume</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># all methods will add charge and volume to this atom.</span>
            <span class="c1"># assigning it here potentially avoids divide by zeros for</span>
            <span class="c1"># core features</span>
            <span class="n">atom_charge</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">charge</span>
            <span class="n">atom_volume</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">volume</span>

        <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;equal&quot;</span><span class="p">:</span>
            <span class="c1"># evenly split the feature to each neighboring atom</span>
            <span class="n">atom_charge</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">charge</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom_counts</span>
            <span class="n">atom_volume</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">volume</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">))</span> <span class="o">*</span> <span class="n">atom_counts</span>

        <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;pauling&quot;</span><span class="p">:</span>
            <span class="c1"># get the pauling ens for coordinated atoms</span>
            <span class="n">ens</span> <span class="o">=</span> <span class="n">pauling_ens</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>
            <span class="c1"># normalize to the total en</span>
            <span class="n">ens</span> <span class="o">/=</span> <span class="n">ens</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="c1"># get the weights for each unique atom</span>
            <span class="n">ens</span> <span class="o">=</span> <span class="n">ens</span><span class="p">[</span><span class="n">unique_indices</span><span class="p">]</span>
            <span class="n">atom_charge</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">ens</span> <span class="o">*</span> <span class="n">atom_counts</span>
            <span class="n">atom_volume</span><span class="p">[</span><span class="n">unique_atoms</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">ens</span> <span class="o">*</span> <span class="n">atom_counts</span>

        <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;dist&quot;</span><span class="p">:</span>
            <span class="c1"># get the dist to each coordinated atom</span>
            <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_dists_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># invert and normalize</span>
            <span class="n">dists</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dists</span>
            <span class="n">dists</span> <span class="o">/=</span> <span class="n">dists</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="c1"># add for each atom</span>
            <span class="k">for</span> <span class="n">coord_idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">):</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">dists</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">dists</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">:</span>
            <span class="c1"># get the dist to each coordinated atom and their radii</span>
            <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_atoms_dists_e</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">atom_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii_e</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">atom_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_elf_radii</span><span class="p">[</span><span class="n">coord_atoms</span><span class="p">]</span>

            <span class="c1"># calculate the weighted contribution to each atom and normalize</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">atom_radii</span> <span class="o">/</span> <span class="n">dists</span>
            <span class="n">weight</span> <span class="o">/=</span> <span class="n">weight</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="c1"># add for each atom</span>
            <span class="k">for</span> <span class="n">coord_idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord_atoms</span><span class="p">):</span>
                <span class="n">atom_charge</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span> <span class="o">*</span> <span class="n">weight</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>
                <span class="n">atom_volume</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">weight</span><span class="p">[</span><span class="n">coord_idx</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">splitting_method</span> <span class="o">==</span> <span class="s2">&quot;nearest&quot;</span><span class="p">:</span>
            <span class="c1"># assign all charge/volume to the closest atom</span>
            <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coord_dists</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">])</span>
            <span class="n">atom_charge</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">charge</span>
            <span class="n">atom_volume</span><span class="p">[</span><span class="n">nearest</span><span class="p">]</span> <span class="o">+=</span> <span class="n">volume</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">splitting_method</span><span class="si">}</span><span class="s2">&#39; is not a valid splitting method&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">atom_charge</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">atom_volume</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_feature_labels</span><span class="p">(</span><span class="n">included_features</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span> <span class="n">return_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_feat_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_charge_volume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order_by_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_labels" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Assigns each grid point to atoms and features included in the 'included_features'
tag. The assignments are represented by an array with the same dimensions
as the charge/reference grids with integers representing the atom/feature
index in the Structure object including requested feature dummy atoms.
By default this method orders requested features so that atoms
come first, followed by electrides, and then any other feature types. This
is for methods such as BadELF which rely on this ordering scheme.</p>
<p>Atoms are included by default and it is generally not recommended to include
core/shell features. If these are of interest to you, reach out to us
on our <a href="https://github.com/SWeav02/baderkit">github</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>included_features</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The features to include in addition to the atoms. The default is FeatureType.valence_types.</p>
              </div>
            </td>
            <td>
                  <code><span title="baderkit.core.labelers.bifurcation_graph.FeatureType.valence_types">valence_types</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_structure</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to return the structure that the index labels correspond
to. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_feat_indices</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to return the original feature indices in their new
order. The default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_by_type</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to reorder the structure prior to assigning to
grid points. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_charge_volume</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to return the corresponding charge/volume associated
with each feature</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array representing grid point assignments. If return_structure or
return_feat_indices is set to True, these are returned as well. The
returned result is always a tuple, even if only the feature assignments
are requested.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_feature_labels</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">included_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span>
    <span class="n">return_structure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_feat_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_charge_volume</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">order_by_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Assigns each grid point to atoms and features included in the &#39;included_features&#39;</span>
<span class="sd">    tag. The assignments are represented by an array with the same dimensions</span>
<span class="sd">    as the charge/reference grids with integers representing the atom/feature</span>
<span class="sd">    index in the Structure object including requested feature dummy atoms.</span>
<span class="sd">    By default this method orders requested features so that atoms</span>
<span class="sd">    come first, followed by electrides, and then any other feature types. This</span>
<span class="sd">    is for methods such as BadELF which rely on this ordering scheme.</span>

<span class="sd">    Atoms are included by default and it is generally not recommended to include</span>
<span class="sd">    core/shell features. If these are of interest to you, reach out to us</span>
<span class="sd">    on our [github](https://github.com/SWeav02/baderkit)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    included_features : list[str], optional</span>
<span class="sd">        The features to include in addition to the atoms. The default is FeatureType.valence_types.</span>
<span class="sd">    return_structure : bool, optional</span>
<span class="sd">        Whether or not to return the structure that the index labels correspond</span>
<span class="sd">        to. The default is True.</span>
<span class="sd">    return_feat_indices : bool, optional</span>
<span class="sd">        Whether or not to return the original feature indices in their new</span>
<span class="sd">        order. The default is False.</span>
<span class="sd">    order_by_type : bool, optional</span>
<span class="sd">        Whether or not to reorder the structure prior to assigning to</span>
<span class="sd">        grid points. The default is True.</span>
<span class="sd">    return_charge_volume : bool, optional</span>
<span class="sd">        Whether or not to return the corresponding charge/volume associated</span>
<span class="sd">        with each feature</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        An array representing grid point assignments. If return_structure or</span>
<span class="sd">        return_feat_indices is set to True, these are returned as well. The</span>
<span class="sd">        returned result is always a tuple, even if only the feature assignments</span>
<span class="sd">        are requested.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the original basin atom assignments</span>
    <span class="n">basin_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># get indices of requested type</span>
    <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_features</span><span class="p">)</span>

    <span class="c1"># reorder features so that electrides are first if requested</span>
    <span class="k">if</span> <span class="n">order_by_type</span><span class="p">:</span>
        <span class="n">bare_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">other_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                <span class="n">bare_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="n">bare_feature_indices</span> <span class="o">+</span> <span class="n">other_feature_indices</span>

    <span class="c1"># reassign basin atoms and get structure</span>
    <span class="n">feature_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">new_atom_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sorted_idx</span><span class="p">,</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">):</span>
        <span class="c1"># update basin labels</span>
        <span class="n">basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
        <span class="n">basin_atoms</span><span class="p">[</span><span class="n">basins</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_atom_idx</span>
        <span class="n">new_atom_idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># add feature to structure</span>
        <span class="n">species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span><span class="o">.</span><span class="n">dummy_species</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_average_frac_coords</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
        <span class="n">feature_structure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>

    <span class="c1"># NOTE: append -1 so that vacuum gets assigned to -1 in the atom_labels</span>
    <span class="c1"># array</span>
    <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># reassign labels</span>
    <span class="n">feature_labels</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">]</span>

    <span class="c1"># get requested results</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">((</span><span class="n">return_structure</span><span class="p">,</span> <span class="n">return_feat_indices</span><span class="p">,</span> <span class="n">return_charge_volume</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">feature_labels</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature_labels</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_structure</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_feat_indices</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_charge_volume</span><span class="p">:</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">atom_charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
            <span class="n">basin_atoms</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_charges</span><span class="p">,</span>
            <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">atom_volumes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
            <span class="n">basin_atoms</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_volumes</span><span class="p">,</span>
            <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_structure</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_charges</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_volumes</span><span class="p">)</span>

    <span class="c1"># return labels</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_feature_structure</span><span class="p">(</span><span class="n">included_features</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span> <span class="n">return_feat_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order_by_type</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a PyMatGen Structure object with dummy atoms for each requested
feature. By default this method orders requested features so that atoms
come first, followed by electrides, and then any other feature types.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>included_features</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The features to include in addition to the atoms. The default is FeatureType.valence_types.</p>
              </div>
            </td>
            <td>
                  <code><span title="baderkit.core.labelers.bifurcation_graph.FeatureType.valence_types">valence_types</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_feat_indices</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to return the original feature indices in their new
order. The default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_by_type</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to reorder the structure. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DESCRIPTION.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_feature_structure</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">included_features</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">valence_types</span><span class="p">,</span>
    <span class="n">return_feat_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">order_by_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Generates a PyMatGen Structure object with dummy atoms for each requested</span>
<span class="sd">    feature. By default this method orders requested features so that atoms</span>
<span class="sd">    come first, followed by electrides, and then any other feature types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    included_features : list[str], optional</span>
<span class="sd">        The features to include in addition to the atoms. The default is FeatureType.valence_types.</span>
<span class="sd">    return_feat_indices : bool, optional</span>
<span class="sd">        Whether or not to return the original feature indices in their new</span>
<span class="sd">        order. The default is False.</span>
<span class="sd">    order_by_type : bool, optional</span>
<span class="sd">        Whether or not to reorder the structure. The default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Structure</span>
<span class="sd">        DESCRIPTION.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get indices of requested type</span>
    <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_features</span><span class="p">)</span>

    <span class="c1"># reorder features so that electrides are first if requested</span>
    <span class="k">if</span> <span class="n">order_by_type</span><span class="p">:</span>
        <span class="n">bare_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">other_feature_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span> <span class="ow">in</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">bare_types</span><span class="p">:</span>
                <span class="n">bare_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_feature_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_idx</span><span class="p">)</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="n">bare_feature_indices</span> <span class="o">+</span> <span class="n">other_feature_indices</span>

    <span class="c1"># get structure from indices</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_feat_indices</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">structure</span><span class="p">,</span> <span class="n">feature_indices</span>

    <span class="k">return</span> <span class="n">structure</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure_by_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_feature_structure_by_index" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a PyMatGen Structure object with dummy atoms for each requested
feature. This method does not reorder features.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_indices</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The indices of features to include.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>structure</code></td>            <td>
                  <code><span title="baderkit.core.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The system's PyMatGen Structure including dummy atoms representing
requested features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_feature_structure_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Generates a PyMatGen Structure object with dummy atoms for each requested</span>
<span class="sd">    feature. This method does not reorder features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    feature_indices : list[int]</span>
<span class="sd">        The indices of features to include.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    structure : Structure</span>
<span class="sd">        The system&#39;s PyMatGen Structure including dummy atoms representing</span>
<span class="sd">        requested features.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create a new structure without oxidation states</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">structure</span><span class="o">.</span><span class="n">remove_oxidation_states</span><span class="p">()</span>

    <span class="c1"># add each feature</span>
    <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
        <span class="n">structure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_types</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span><span class="o">.</span><span class="n">dummy_species</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_average_frac_coords</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">structure</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_oxidation_and_volumes_from_potcar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span><span class="n">potcar_path</span><span class="o">=</span><span class="s1">&#39;POTCAR&#39;</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.get_oxidation_and_volumes_from_potcar" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the oxidation states, charges, and volumes associated with each
atom/electride using the information from a provided POTCAR.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>potcar_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the POTCAR file. The default is "POTCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;POTCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_electrides</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to treat electrides as quasi atoms. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any keyword arguments to pass to the 'get_charges_and_volumes' method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>three arrays representing the oxidation states, charges, and volumes
respectively.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span> <span class="n">use_electrides</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the oxidation states, charges, and volumes associated with each</span>
<span class="sd">    atom/electride using the information from a provided POTCAR.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    potcar_path : Path, optional</span>
<span class="sd">        The path to the POTCAR file. The default is &quot;POTCAR&quot;.</span>
<span class="sd">    use_electrides : bool, optional</span>
<span class="sd">        Whether or not to treat electrides as quasi atoms. The default is True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Any keyword arguments to pass to the &#39;get_charges_and_volumes&#39; method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[NDArray]</span>
<span class="sd">        three arrays representing the oxidation states, charges, and volumes</span>
<span class="sd">        respectively.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span>
        <span class="n">use_electrides</span><span class="o">=</span><span class="n">use_electrides</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="c1"># convert to path</span>
    <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
    <span class="c1"># load</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">potcars</span> <span class="o">=</span> <span class="n">Potcar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
    <span class="n">nelectron_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># the result is a list because there can be multiple element potcars</span>
    <span class="c1"># in the file (e.g. for NaCl, POTCAR = POTCAR_Na + POTCAR_Cl)</span>
    <span class="k">for</span> <span class="n">potcar</span> <span class="ow">in</span> <span class="n">potcars</span><span class="p">:</span>
        <span class="n">nelectron_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">potcar</span><span class="o">.</span><span class="n">element</span><span class="p">:</span> <span class="n">potcar</span><span class="o">.</span><span class="n">nelectrons</span><span class="p">})</span>
    <span class="c1"># calculate oxidation states</span>
    <span class="k">if</span> <span class="n">use_electrides</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electride_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

    <span class="n">oxi_state_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">site</span><span class="p">,</span> <span class="n">site_charge</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">charges</span><span class="p">):</span>
        <span class="n">element_str</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span>
        <span class="n">val_electrons</span> <span class="o">=</span> <span class="n">nelectron_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element_str</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">oxi_state</span> <span class="o">=</span> <span class="n">val_electrons</span> <span class="o">-</span> <span class="n">site_charge</span>
        <span class="n">oxi_state_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxi_state</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">oxi_state_data</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">charges</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">volumes</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">(</span><span class="n">potcar_path</span><span class="o">=</span><span class="s1">&#39;POTCAR&#39;</span><span class="p">,</span> <span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">splitting_method</span><span class="o">=</span><span class="s1">&#39;weighted_dist&#39;</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_dict" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets a dictionary summary of the ElfLabeler analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>potcar_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to a POTCAR file. This must be provided for oxidation states
to be calculated, and they will be None otherwise. The default is "POTCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;POTCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_json</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convert all entries to JSONable data types. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>splitting_method</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;equal&#39;, &#39;pauling&#39;, &#39;dist&#39;, &#39;weighted_dist&#39;, &#39;nearest&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See :meth:<code>write_feature_basins</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;weighted_dist&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A summary of the ElfLabeler analysis in dictionary form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span>
    <span class="n">use_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">splitting_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="s2">&quot;pauling&quot;</span><span class="p">,</span> <span class="s2">&quot;dist&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span> <span class="s2">&quot;nearest&quot;</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weighted_dist&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Gets a dictionary summary of the ElfLabeler analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    potcar_path : Path | str, optional</span>
<span class="sd">        The Path to a POTCAR file. This must be provided for oxidation states</span>
<span class="sd">        to be calculated, and they will be None otherwise. The default is &quot;POTCAR&quot;.</span>
<span class="sd">    use_json : bool, optional</span>
<span class="sd">        Convert all entries to JSONable data types. The default is True.</span>
<span class="sd">    splitting_method : Literal[&quot;equal&quot;, &quot;pauling&quot;, &quot;dist&quot;, &quot;weighted_dist&quot;, &quot;nearest&quot;], optional</span>
<span class="sd">        See :meth:`write_feature_basins`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A summary of the ElfLabeler analysis in dictionary form.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># collect method kwargs</span>
    <span class="n">method_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;splitting_method&quot;</span><span class="p">:</span> <span class="n">splitting_method</span><span class="p">,</span>
        <span class="s2">&quot;crystalnn_kwargs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystalnn_kwargs</span><span class="p">,</span>
        <span class="s2">&quot;ignore_low_pseudopotentials&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_low_pseudopotentials</span><span class="p">,</span>
        <span class="s2">&quot;shared_shell_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_shell_ratio</span><span class="p">,</span>
        <span class="s2">&quot;covalent_molecule_ratio&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">covalent_molecule_ratio</span><span class="p">,</span>
        <span class="s2">&quot;min_covalent_charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_charge</span><span class="p">,</span>
        <span class="s2">&quot;min_covalent_angle&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_covalent_angle</span><span class="p">,</span>
        <span class="s2">&quot;min_electride_elf_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_elf_value</span><span class="p">,</span>
        <span class="s2">&quot;min_electride_depth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_depth</span><span class="p">,</span>
        <span class="s2">&quot;min_electride_charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_charge</span><span class="p">,</span>
        <span class="s2">&quot;min_electride_volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_volume</span><span class="p">,</span>
        <span class="s2">&quot;min_electride_dist_beyond_atom&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_electride_dist_beyond_atom</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;method_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method_kwargs</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;spin_system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_system</span>

    <span class="c1"># only try to calculate oxidation state if this was not a half spin system</span>
    <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_system</span> <span class="o">==</span> <span class="s2">&quot;total&quot;</span> <span class="ow">and</span> <span class="n">potcar_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">oxidation_states</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
                <span class="n">potcar_path</span><span class="o">=</span><span class="n">potcar_path</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">oxidation_states_e</span><span class="p">,</span> <span class="n">charges_e</span><span class="p">,</span> <span class="n">volumes_e</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_and_volumes_from_potcar</span><span class="p">(</span>
                <span class="n">potcar_path</span><span class="o">=</span><span class="n">potcar_path</span><span class="p">,</span> <span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">oxidation_states</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">oxidation_states_e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">charges</span><span class="p">,</span> <span class="n">volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">charges_e</span><span class="p">,</span> <span class="n">volumes_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_charges_and_volumes</span><span class="p">(</span><span class="n">use_electrides</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oxidation_states</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oxidation_states</span> <span class="o">=</span> <span class="n">oxidation_states</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">oxidation_states_e</span> <span class="o">=</span> <span class="n">oxidation_states_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxidation_states</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oxidation_states_e</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;charges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">charges</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;charges_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">charges_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;volumes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volumes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;volumes_e&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">volumes_e</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># add objects that can convert to json</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;labeled_structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;electride_structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bifurcation_graph&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">use_json</span><span class="p">:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

    <span class="c1"># add objects that are arrays</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;atom_elf_radii&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_elf_radii_types&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_elf_radii_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_elf_radii_types_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_max_values_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_max_values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_min_values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_charges&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_volumes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_coord_nums&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_coord_nums_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_min_surface_dists&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_avg_surface_dists&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_json</span> <span class="ow">and</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

    <span class="c1"># add objects that are lists with arrays</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;feature_coord_dists&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_coord_atoms_dists_e&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_json</span> <span class="ow">and</span> <span class="n">result_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_obj</span><span class="p">]</span>
        <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_obj</span>

    <span class="c1"># add other objects that are already jsonable</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;nelectrides&quot;</span><span class="p">,</span>
        <span class="s2">&quot;electride_formula&quot;</span><span class="p">,</span>
        <span class="s2">&quot;electrides_per_formula&quot;</span><span class="p">,</span>
        <span class="s2">&quot;electrides_per_reduced_formula&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_types&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_coord_atoms&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_coord_atoms_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_feature_indices_e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_electron_number&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_volume&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vacuum_charge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vacuum_volume&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.to_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a JSON string representation of the results, typically for writing
results to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments for the to_dict method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON string representation of the BadELF results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a JSON string representation of the results, typically for writing</span>
<span class="sd">    results to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for the to_dict method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A JSON string representation of the BadELF results.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_all_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_all_features</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_all_features" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the bader basins associated with all features</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See :meth:<code>write_feature_basins</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_all_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the bader basins associated with all features</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        See :meth:`write_feature_basins`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins</span><span class="p">(</span>
        <span class="n">feature_indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_charges</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_bifurcation_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_bifurcation_plot</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_bifurcation_plot" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the BifurcationPlot to an html file. This is just a shortcut for
ElfLabeler.bifurcation_plot.write_html.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to write the plot to. 'html' will be appended if it is not
present in the path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_bifurcation_plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Writes the BifurcationPlot to an html file. This is just a shortcut for</span>
<span class="sd">    ElfLabeler.bifurcation_plot.write_html.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str | Path</span>
<span class="sd">        The Path to write the plot to. &#39;html&#39; will be appended if it is not</span>
<span class="sd">        present in the path.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bifurcation_plot</span>
    <span class="c1"># make sure path is a Path object</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># add .html if filename doesn&#39;t include it</span>
    <span class="n">filename_html</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.html&quot;</span><span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">write_html</span><span class="p">(</span><span class="n">filename_html</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_feature_basins</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="n">include_dummy_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>For a give list of node keys, writes the bader basins associated with
each.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_indices</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which features to write basin volumes for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span>(&#39;.&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_dummy_atoms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to add dummy files to the structure. The default is False.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_feature_basins</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
    <span class="n">include_dummy_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For a give list of node keys, writes the bader basins associated with</span>
<span class="sd">    each.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    feature_indices : list[int]</span>
<span class="sd">        Which features to write basin volumes for.</span>
<span class="sd">    directory : str | Path, optional</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    include_dummy_atoms : bool, optional</span>
<span class="sd">        Whether or not to add dummy files to the structure. The default is False.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

    <span class="c1"># get structure</span>
    <span class="k">if</span> <span class="n">include_dummy_atoms</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

    <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
        <span class="n">basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">]</span>
        <span class="c1"># get mask where this feature is NOT</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basins</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_f</span><span class="si">{</span><span class="n">feat_idx</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_feature_basins_sum</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="n">include_dummy_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_feature_basins_sum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>For a give list of node keys, writes the union of the bader basins
associated with each.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_indices</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which features to include in the volume.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span>(&#39;.&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_dummy_atoms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to add dummy files to the structure. The default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_feature_basins_sum</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">feature_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
    <span class="n">include_dummy_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For a give list of node keys, writes the union of the bader basins</span>
<span class="sd">    associated with each.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    feature_indices : list[int]</span>
<span class="sd">        Which features to include in the volume.</span>
<span class="sd">    directory : str | Path, optional</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    include_dummy_atoms : bool, optional</span>
<span class="sd">        Whether or not to add dummy files to the structure. The default is False.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

    <span class="c1"># get structure</span>
    <span class="k">if</span> <span class="n">include_dummy_atoms</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_structure_by_index</span><span class="p">(</span><span class="n">feature_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

    <span class="c1"># get all basin indices to include</span>
    <span class="n">basin_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">feat_idx</span> <span class="ow">in</span> <span class="n">feature_indices</span><span class="p">:</span>
        <span class="n">basin_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_basins</span><span class="p">[</span><span class="n">feat_idx</span><span class="p">])</span>

    <span class="c1"># get mask where features are not</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bader</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basin_list</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
    <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
        <span class="n">structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_fsum&quot;</span>
    <span class="c1"># write file</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_features_by_type</span><span class="p">(</span><span class="n">included_types</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the bader basins associated with all features of the selected type</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>included_types</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="baderkit.core.labelers.bifurcation_graph.FeatureType">FeatureType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The types of features to include, e.g. metallic, lone-pair, etc.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See :meth:<code>write_feature_basins</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_features_by_type</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">included_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span><span class="p">],</span>
    <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the bader basins associated with all features of the selected type</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    included_types : list[FeatureType]</span>
<span class="sd">        The types of features to include, e.g. metallic, lone-pair, etc.</span>
<span class="sd">    prefix_override : str</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is True.</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        See :meth:`write_feature_basins`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>
    <span class="k">for</span> <span class="n">feature_type</span> <span class="ow">in</span> <span class="n">included_types</span><span class="p">:</span>
        <span class="n">feature_type</span> <span class="o">=</span> <span class="n">FeatureType</span><span class="p">(</span><span class="n">feature_type</span><span class="p">)</span>
        <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">([</span><span class="n">feature_type</span><span class="p">])</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_override</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">feature_type</span><span class="o">.</span><span class="n">dummy_species</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins_sum</span><span class="p">(</span>
            <span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span><span class="p">,</span>
            <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># rename to remove fsum</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_fsum&quot;</span><span class="p">,</span>
            <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_features_by_type_sum</span><span class="p">(</span><span class="n">included_types</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_features_by_type_sum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the union of the bader basins associated with all features of the
selected type</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See :meth:<code>write_feature_basins_sum</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_features_by_type_sum</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">included_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FeatureType</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the union of the bader basins associated with all features of the</span>
<span class="sd">    selected type</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        See :meth:`write_feature_basins_sum`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">feature_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_indices_by_type</span><span class="p">(</span><span class="n">included_types</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_feature_basins_sum</span><span class="p">(</span><span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_json</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;elf_labeler.json&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.labelers.elf_labeler.ElfLabeler.write_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes results of the analysis to file in a JSON format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to write the results to. The default is "elf_labeler.json".</p>
              </div>
            </td>
            <td>
                  <code>&#39;elf_labeler.json&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keyword arguments for the to_dict method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/labelers/elf_labeler/elf_labeler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;elf_labeler.json&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes results of the analysis to file in a JSON format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : Path | str, optional</span>
<span class="sd">        The Path to write the results to. The default is &quot;elf_labeler.json&quot;.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        keyword arguments for the to_dict method.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.annotate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>