
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sweav02.github.io/baderkit/api_reference/core/bader/">
      
      
        <link rel="prev" href="../../../elf_labeler/background/">
      
      
        <link rel="next" href="../grid/">
      
      
        
      
      
      <link rel="icon" href="../../../images/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Bader - BaderKit Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.baderkit.core.bader.Bader" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="BaderKit Documentation" class="md-header__button md-logo" aria-label="BaderKit Documentation" data-md-component="logo">
      
  <img src="../../../images/logo_icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BaderKit Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bader
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/SWeav02/baderkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BaderKit Documentation" class="md-nav__button md-logo" aria-label="BaderKit Documentation" data-md-component="logo">
      
  <img src="../../../images/logo_icon.svg" alt="logo">

    </a>
    BaderKit Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SWeav02/baderkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bader
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bader/methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    BadELF
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    BadELF
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../badelf/methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ElfLabeler
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    ElfLabeler
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../elf_labeler/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../elf_labeler/background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_avg_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_avg_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_edges" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_edges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_min_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_min_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_atom_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_atom_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_atoms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_avg_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_avg_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_edges" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_edges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_charge_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_charge_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_frac" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_frac
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_ref_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_ref_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_vox" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_vox
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_min_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_min_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_tol" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_tol
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.charge_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        charge_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.method" class="md-nav__link">
    <span class="md-ellipsis">
      
        method
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.num_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.reference_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        reference_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.significant_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        significant_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.species" class="md-nav__link">
    <span class="md-ellipsis">
      
        species
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.total_electron_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_electron_number
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.total_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.use_reference_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        use_reference_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_charge" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_charge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_mask
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_tol" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_tol
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.all_methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_methods
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_cube" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_cube
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_dynamic" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_dynamic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_vasp" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_vasp
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_atom_results_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_atom_results_dataframe
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_basin_results_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_basin_results_dataframe
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_oxidation_from_potcar" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_oxidation_from_potcar
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.run_atom_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_atom_assignment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.run_bader" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_bader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_all_atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_all_basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_tsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_tsv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_volumes_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_volumes_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_tsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_tsv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_volumes_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_volumes_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_species_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_species_volume
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../labeler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ElfLabeler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../labeler_spin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpinElfLabeler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../badelf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Badelf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../badelf_spin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpinBadelf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Plotting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/grid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plotting/bader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_avg_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_avg_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_edges" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_edges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_min_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_min_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_atom_dists" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_atom_dists
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_atoms
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_avg_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_avg_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_charges" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_charges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_edges" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_edges
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_labels
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_charge_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_charge_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_frac" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_frac
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_ref_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_ref_values
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_maxima_vox" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_maxima_vox
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_min_surface_distances" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_min_surface_distances
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_tol" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_tol
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.charge_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        charge_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.method" class="md-nav__link">
    <span class="md-ellipsis">
      
        method
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.num_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.reference_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        reference_grid
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.significant_basins" class="md-nav__link">
    <span class="md-ellipsis">
      
        significant_basins
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.species" class="md-nav__link">
    <span class="md-ellipsis">
      
        species
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.total_electron_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_electron_number
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.total_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.use_reference_vacuum" class="md-nav__link">
    <span class="md-ellipsis">
      
        use_reference_vacuum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_charge" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_charge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_mask
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_tol" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_tol
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.vacuum_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        vacuum_volume
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.all_methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_methods
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        copy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_cube" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_cube
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_dynamic" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_dynamic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.from_vasp" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_vasp
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_atom_results_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_atom_results_dataframe
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_basin_results_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_basin_results_dataframe
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.get_oxidation_from_potcar" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_oxidation_from_potcar
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.run_atom_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_atom_assignment
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.run_bader" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_bader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_all_atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_all_basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_all_basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_tsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_tsv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_atom_volumes_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_atom_volumes_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_tsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_tsv
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_volumes" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_volumes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_basin_volumes_sum" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_basin_volumes_sum
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_json
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.baderkit.core.bader.Bader.write_species_volume" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_species_volume
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Bader</h1>

<div class="doc doc-object doc-class">



<a id="src.baderkit.core.bader.Bader"></a>
    <div class="doc doc-contents first">



        <p>Class for running Bader analysis on a regular grid. For information on each
method, see our <a href="https://sweav02.github.io/baderkit/">docs</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_grid</code>
            </td>
            <td>
                  <code><span title="baderkit.core.toolkit.Grid">Grid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Grid object with the charge density that will be integrated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_grid</code>
            </td>
            <td>
                  <code><span title="baderkit.core.toolkit.Grid">Grid</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Grid object whose values will be used to construct the basins. If
None, defaults to the charge_grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="src.baderkit.core.bader.methods.Method">Method</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The algorithm to use for generating bader basins.</p>
              </div>
            </td>
            <td>
                  <code><span title="src.baderkit.core.bader.methods.Method.weight">weight</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vacuum_tol</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a float is provided, this is the value below which a point will
be considered part of the vacuum. If a bool is provided, no vacuum
will be used on False, and the default tolerance will be used on True.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basin_tol</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value below which a basin will not be considered significant. This
is used only used to avoid writing out data that is likely not valuable.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_reference_vacuum</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to use the reference file to determine regions of vacuum
(low charge density). This should generally be set to True unless the
ELF is being used as the reference. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Bader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for running Bader analysis on a regular grid. For information on each</span>
<span class="sd">    method, see our [docs](https://sweav02.github.io/baderkit/)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_grid : Grid</span>
<span class="sd">        A Grid object with the charge density that will be integrated.</span>
<span class="sd">    reference_grid : Grid | None</span>
<span class="sd">        A Grid object whose values will be used to construct the basins. If</span>
<span class="sd">        None, defaults to the charge_grid.</span>
<span class="sd">    method : str | Method, optional</span>
<span class="sd">        The algorithm to use for generating bader basins.</span>
<span class="sd">    vacuum_tol : float | bool, optional</span>
<span class="sd">        If a float is provided, this is the value below which a point will</span>
<span class="sd">        be considered part of the vacuum. If a bool is provided, no vacuum</span>
<span class="sd">        will be used on False, and the default tolerance will be used on True.</span>
<span class="sd">    basin_tol : float, optional</span>
<span class="sd">        The value below which a basin will not be considered significant. This</span>
<span class="sd">        is used only used to avoid writing out data that is likely not valuable.</span>
<span class="sd">    use_reference_vacuum : bool, optional</span>
<span class="sd">        Whether or not to use the reference file to determine regions of vacuum</span>
<span class="sd">        (low charge density). This should generally be set to True unless the</span>
<span class="sd">        ELF is being used as the reference. The default is True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">charge_grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span>
        <span class="n">reference_grid</span><span class="p">:</span> <span class="n">Grid</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Method</span> <span class="o">=</span> <span class="n">Method</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span>
        <span class="n">vacuum_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="mf">1.0e-3</span><span class="p">,</span>
        <span class="c1"># normalize_vacuum: bool | None = None,</span>
        <span class="n">basin_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-3</span><span class="p">,</span>
        <span class="n">use_reference_vacuum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="c1"># ensure th method is valid</span>
        <span class="n">valid_methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">Method</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">Method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">valid_methods</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">Method</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Available options are: </span><span class="si">{</span><span class="n">valid_methods</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_charge_grid</span> <span class="o">=</span> <span class="n">charge_grid</span>

        <span class="c1"># if no reference is provided, use the base charge grid</span>
        <span class="k">if</span> <span class="n">reference_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">charge_grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reference_grid</span> <span class="o">=</span> <span class="n">reference_grid</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_use_reference_vacuum</span> <span class="o">=</span> <span class="n">use_reference_vacuum</span>

        <span class="c1"># if vacuum tolerance is True, set it to the same default as above</span>
        <span class="k">if</span> <span class="n">vacuum_tol</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_tol</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_tol</span> <span class="o">=</span> <span class="n">vacuum_tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basin_tol</span> <span class="o">=</span> <span class="n">basin_tol</span>

        <span class="c1"># set hidden class variables. This allows us to cache properties and</span>
        <span class="c1"># still be able to recalculate them if needed, though that should only</span>
        <span class="c1"># be done by advanced users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">()</span>

        <span class="c1"># whether or not to use overdetermined gradients in neargrid methods.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_overdetermined</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Set Properties</span>
    <span class="c1">###########################################################################</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_reset_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">include_properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">):</span>
        <span class="c1"># if include properties is not provided, we wnat to reset everything</span>
        <span class="k">if</span> <span class="n">include_properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">include_properties</span> <span class="o">=</span> <span class="p">[</span>
                <span class="c1"># assigned by run_bader</span>
                <span class="s2">&quot;basin_labels&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_frac&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_charge_values&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_ref_values&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_vox&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_charges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_volumes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;vacuum_charge&quot;</span><span class="p">,</span>
                <span class="s2">&quot;vacuum_volume&quot;</span><span class="p">,</span>
                <span class="s2">&quot;significant_basins&quot;</span><span class="p">,</span>
                <span class="s2">&quot;vacuum_mask&quot;</span><span class="p">,</span>
                <span class="s2">&quot;num_vacuum&quot;</span><span class="p">,</span>
                <span class="c1"># Assigned by calling the property</span>
                <span class="s2">&quot;basin_min_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_avg_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_edges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_edges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
                <span class="c1"># Assigned by run_atom_assignment</span>
                <span class="s2">&quot;basin_atoms&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_atom_dists&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_labels&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_charges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_volumes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_min_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_avg_surface_distances&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="c1"># get our final list of properties</span>
        <span class="n">reset_properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">include_properties</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_properties</span>
        <span class="p">]</span>
        <span class="c1"># set corresponding hidden variable to None</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">reset_properties</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Structure</span>
<span class="sd">            The pymatgen structure basins are assigned to.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span><span class="o">.</span><span class="n">relabel_sites</span><span class="p">(</span><span class="n">ignore_uniq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">species</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[str]</span>
<span class="sd">            The species of each atom/dummy atom in the electride structure. Covalent</span>
<span class="sd">            and metallic features are not included.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">charge_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grid</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Grid</span>
<span class="sd">            A Grid object with the charge density that will be integrated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_charge_grid</span>

    <span class="nd">@charge_grid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">charge_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Grid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_charge_grid</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reference_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grid</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Grid</span>
<span class="sd">            A grid object whose values will be used to construct the basins.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reference_grid</span>

    <span class="nd">@reference_grid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reference_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Grid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reference_grid</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The algorithm to use for generating bader basins. If None, defaults</span>
<span class="sd">            to neargrid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span>

    <span class="nd">@method</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Method</span><span class="p">):</span>
        <span class="c1"># Support both Method instances and their string values</span>
        <span class="n">valid_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">Method</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Method</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">valid_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">Method</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid method &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;. Available options are: </span><span class="si">{</span><span class="n">valid_values</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">(</span><span class="n">exclude_properties</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;vacuum_mask&quot;</span><span class="p">,</span> <span class="s2">&quot;num_vacuum&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_tol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The value below which a point will be considered part of the vacuum.</span>
<span class="sd">            The default is 0.001.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_tol</span>

    <span class="nd">@vacuum_tol</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_tol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_tol</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">()</span>
        <span class="c1"># TODO: only reset everything if the vacuum actually changes</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">use_reference_vacuum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether or not to use the reference file to determine regions of vacuum</span>
<span class="sd">            (low charge density). This should generally be set to True unless the</span>
<span class="sd">            ELF is being used as the reference. The default is True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_reference_vacuum</span>

    <span class="nd">@use_reference_vacuum</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">use_reference_vacuum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_reference_vacuum</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">()</span>
        <span class="c1"># TODO: only reset everything if the vacuum actually changes</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_tol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The value below which a basin will not be considered significant. This</span>
<span class="sd">            is used to avoid writing out data that is likely not valuable.</span>
<span class="sd">            The default is 0.001.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_tol</span>

    <span class="nd">@basin_tol</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_tol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basin_tol</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset_properties</span><span class="p">(</span><span class="n">include_properties</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;significant_basins&quot;</span><span class="p">])</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Calculated Properties</span>
    <span class="c1">###########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            A 3D array of the same shape as the reference grid with entries</span>
<span class="sd">            representing the basin the voxel belongs to. Note that for some</span>
<span class="sd">            methods (e.g. weight) the voxels have weights for each basin.</span>
<span class="sd">            These will be stored in the basin_weights property.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_maxima_frac</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The fractional coordinates of each attractor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_frac</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_frac</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_maxima_charge_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The charge data value at each maximum. If the maximum is</span>
<span class="sd">            off grid, this value will be interpolated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_charge_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_charge_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">values_at</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_charge_values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_maxima_ref_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The reference data value at each maximum. If the maximum is</span>
<span class="sd">            off grid, this value will be interpolated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_ref_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># we get these values during each bader method anyways, so</span>
            <span class="c1"># we run this here.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_ref_values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_maxima_vox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[int]</span>
<span class="sd">            The voxel coordinates of each attractor. There may be more of these</span>
<span class="sd">            than the fractional coordinates, as some maxima sit exactly between</span>
<span class="sd">            several voxels.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_vox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_maxima_vox</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_charges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The charges assigned to each attractor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_charges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_charges</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The volume assigned to each attractor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_volumes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_volumes</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_min_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The distance from each basin maxima to the nearest point on</span>
<span class="sd">            the basins surface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_min_surface_distances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_basin_surface_distances</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_min_surface_distances</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_avg_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The avg distance from each basin maxima to the edges of its basin</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_avg_surface_distances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_basin_surface_distances</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_avg_surface_distances</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The atom index of each basin is assigned to.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_atom_assignment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atoms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_atom_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The distance from each attractor to the nearest atom</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atom_dists</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_atom_assignment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atom_dists</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">significant_basins</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[bool]</span>
<span class="sd">            A 1D mask with an entry for each basin that is True where basins</span>
<span class="sd">            are significant.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_significant_basins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_significant_basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_charges</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_tol</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_significant_basins</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            A 3D array of the same shape as the reference grid with entries</span>
<span class="sd">            representing the atoms the voxel belongs to.</span>

<span class="sd">            Note that for some methods (e.g. weight) some voxels have fractional</span>
<span class="sd">            assignments for each basin and this will not represent exactly how</span>
<span class="sd">            charges are assigned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_atom_assignment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_charges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The charge assigned to each atom</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_charges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_atom_assignment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_charges</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The volume assigned to each atom</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_volumes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_atom_assignment</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_volumes</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_min_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The distance from each atom to the nearest point on the atoms surface.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_min_surface_distances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_atom_surface_distances</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_min_surface_distances</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_avg_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[float]</span>
<span class="sd">            The avg distance from each atom to the edges of its basin</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_avg_surface_distances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_basin_surface_distances</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_avg_surface_distances</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">basin_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[np.bool_]</span>
<span class="sd">            A mask with the same shape as the input grids that is True at points</span>
<span class="sd">            on basin edges.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_basin_edges</span> <span class="o">=</span> <span class="n">get_edges</span><span class="p">(</span>
                <span class="n">labeled_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span>
                <span class="n">vacuum_mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">),</span>
                <span class="n">neighbor_transforms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">point_neighbor_transforms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_edges</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atom_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[np.bool_]</span>
<span class="sd">            A mask with the same shape as the input grids that is True at points</span>
<span class="sd">            on atom edges.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_edges</span> <span class="o">=</span> <span class="n">get_edges</span><span class="p">(</span>
                <span class="n">labeled_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span><span class="p">,</span>
                <span class="n">vacuum_mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">),</span>
                <span class="n">neighbor_transforms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">point_neighbor_transforms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_edges</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The charge assigned to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_charge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_charge</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total volume assigned to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_volume</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bader</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_volume</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vacuum_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray[bool]</span>
<span class="sd">            A mask representing the voxels that belong to the vacuum.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get appropriate grid</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_reference_vacuum</span><span class="p">:</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="c1"># if vacuum tolerance is set to False, ignore vacuum</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_tol</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># get vacuum mask</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_mask</span> <span class="o">=</span> <span class="n">grid</span> <span class="o">&lt;</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_tol</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">volume</span>  <span class="c1"># normalize</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vacuum_mask</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_vacuum</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of vacuum points in the array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_vacuum</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_vacuum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_mask</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_vacuum</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_electron_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total number of electrons in the system calculated from the</span>
<span class="sd">            atom charges and vacuum charge. If this does not match the true</span>
<span class="sd">            total electron number within reasonable floating point error,</span>
<span class="sd">            there is a major problem.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_charge</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The total volume integrated in the system. This should match the</span>
<span class="sd">            volume of the structure. If it does not there may be a serious problem.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_volumes</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_volume</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_methods</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[str]</span>
<span class="sd">            A list of the available methods.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Method</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_bader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the entire Bader process and saves results to class variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Beginning Bader Algorithm Using &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; Method&quot;</span><span class="p">)</span>
        <span class="c1"># Normalize the method name to a module and class name</span>
        <span class="n">module_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span>
        <span class="p">)</span>  <span class="c1"># &#39;pseudo-neargrid&#39; -&gt; &#39;pseudo_neargrid&#39;</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">module_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;Method&quot;</span>
        <span class="p">)</span>

        <span class="c1"># import method</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;baderkit.core.bader.methods.</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">Method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>

        <span class="c1"># Instantiate and run the selected method</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">Method</span><span class="p">(</span>
            <span class="n">charge_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="p">,</span>
            <span class="n">reference_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="p">,</span>
            <span class="n">vacuum_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_mask</span><span class="p">,</span>
            <span class="n">num_vacuum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_vacuum</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_overdetermined</span><span class="p">:</span>
            <span class="n">method</span><span class="o">.</span><span class="n">_use_overdetermined</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bader Algorithm Complete&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assign_basins_to_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">):</span>

        <span class="c1"># Get basin and atom frac coords</span>
        <span class="n">basins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span>  <span class="c1"># (N_basins, 3)</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span>  <span class="c1"># (N_atoms, 3)</span>

        <span class="c1"># get lattice matrix and number of atoms/basins</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>  <span class="c1"># (3, 3)</span>
        <span class="n">N_basins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">basins</span><span class="p">)</span>

        <span class="c1"># Vectorized deltas, minimumimage wrapping</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">basins</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">diffs</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diffs</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">diffs</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diffs</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Cartesian diffs &amp; distances</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bij,jk-&gt;bik&quot;</span><span class="p">,</span> <span class="n">diffs</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cart</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Basinatom assignment &amp; distances</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (N_basins,)</span>
        <span class="n">basin_atom_dists</span> <span class="o">=</span> <span class="n">dists</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_basins</span><span class="p">),</span> <span class="n">basin_atoms</span><span class="p">]</span>  <span class="c1"># (N_basins,)</span>

        <span class="c1"># Atom labels per grid point</span>
        <span class="c1"># NOTE: append -1 so that vacuum gets assigned to -1 in the atom_labels</span>
        <span class="c1"># array</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">basin_atoms</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">atom_labels</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">]</span>
        <span class="n">basin_atoms</span> <span class="o">=</span> <span class="n">basin_atoms</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">atom_charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
            <span class="n">basin_atoms</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_charges</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">atom_volumes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span>
            <span class="n">basin_atoms</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_volumes</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">atom_labels</span><span class="p">,</span> <span class="n">atom_charges</span><span class="p">,</span> <span class="n">atom_volumes</span><span class="p">,</span> <span class="n">basin_atoms</span><span class="p">,</span> <span class="n">basin_atom_dists</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_atom_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns bader basins to this Bader objects structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ensure bader has run (otherwise our time will include the bader time)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span>

        <span class="c1"># Default structure</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Assigning Atom Properties&quot;</span><span class="p">)</span>
        <span class="c1"># get basin assignments for this bader objects structure</span>
        <span class="n">atom_labels</span><span class="p">,</span> <span class="n">atom_charges</span><span class="p">,</span> <span class="n">atom_volumes</span><span class="p">,</span> <span class="n">basin_atoms</span><span class="p">,</span> <span class="n">basin_atom_dists</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assign_basins_to_structure</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Store everything</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atoms</span> <span class="o">=</span> <span class="n">basin_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atom_dists</span> <span class="o">=</span> <span class="n">basin_atom_dists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_labels</span> <span class="o">=</span> <span class="n">atom_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_charges</span> <span class="o">=</span> <span class="n">atom_charges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_volumes</span> <span class="o">=</span> <span class="n">atom_volumes</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Atom Assignment Finished&quot;</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_oxidation_from_potcar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the oxidation state of each atom from the provided POTCAR</span>
<span class="sd">        file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        potcar_path : Path, optional</span>
<span class="sd">            The path to the POTCAR to calculate oxidation states from. The default is &quot;POTCAR&quot;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArray</span>
<span class="sd">            The oxidation state of each atom in the structure.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># convert to path</span>
        <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">potcar_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No POTCAR file found in the requested directory. Oxidation states cannot be calculated&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># load</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">potcars</span> <span class="o">=</span> <span class="n">Potcar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
        <span class="n">nelectron_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># the result is a list because there can be multiple element potcars</span>
        <span class="c1"># in the file (e.g. for NaCl, POTCAR = POTCAR_Na + POTCAR_Cl)</span>
        <span class="k">for</span> <span class="n">potcar</span> <span class="ow">in</span> <span class="n">potcars</span><span class="p">:</span>
            <span class="n">nelectron_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">potcar</span><span class="o">.</span><span class="n">element</span><span class="p">:</span> <span class="n">potcar</span><span class="o">.</span><span class="n">nelectrons</span><span class="p">})</span>
        <span class="c1"># calculate oxidation states</span>
        <span class="n">oxi_state_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site</span><span class="p">,</span> <span class="n">site_charge</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span><span class="p">):</span>
            <span class="n">element_str</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">name</span>
            <span class="n">oxi_state</span> <span class="o">=</span> <span class="n">nelectron_data</span><span class="p">[</span><span class="n">element_str</span><span class="p">]</span> <span class="o">-</span> <span class="n">site_charge</span>
            <span class="n">oxi_state_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxi_state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">oxi_state_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_atom_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the distance from each atom to the nearest surface. This is</span>
<span class="sd">        automatically called during the atom assignment and generally should</span>
<span class="sd">        not be called manually.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_min_surface_distances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_avg_surface_distances</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_min_avg_surface_dists</span><span class="p">(</span>
                <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span><span class="p">,</span>
                <span class="n">frac_coords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
                <span class="n">edge_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_edges</span><span class="p">,</span>
                <span class="n">matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
                <span class="n">max_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">abc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_basin_surface_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the distance from each basin maxima to the nearest surface.</span>
<span class="sd">        This is automatically called during the atom assignment and generally</span>
<span class="sd">        should not be called manually.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the minimum distances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_basin_min_surface_distances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basin_avg_surface_distances</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_min_avg_surface_dists</span><span class="p">(</span>
                <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span>
                <span class="n">frac_coords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span><span class="p">,</span>
                <span class="n">edge_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_edges</span><span class="p">,</span>
                <span class="n">matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">matrix</span><span class="p">,</span>
                <span class="n">max_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">abc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_vasp</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CHGCAR&quot;</span><span class="p">,</span>
        <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Bader class object from VASP files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        charge_filename : Path | str, optional</span>
<span class="sd">            The path to the CHGCAR like file that will be used for summing charge.</span>
<span class="sd">            The default is &quot;CHGCAR&quot;.</span>
<span class="sd">        reference_filename : Path | None | str, optional</span>
<span class="sd">            The path to CHGCAR like file that will be used for partitioning.</span>
<span class="sd">            If None, the charge file will be used for partitioning.</span>
<span class="sd">        total_only: bool</span>
<span class="sd">            If true, only the first set of data in the file will be read. This</span>
<span class="sd">            increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">            not used.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to pass to the Bader class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            A Bader class object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_cube</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Bader class object from .cube files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        charge_filename : Path | str, optional</span>
<span class="sd">            The path to the .cube file that will be used for summing charge.</span>
<span class="sd">        reference_filename : Path | None | str, optional</span>
<span class="sd">            The path to .cube file that will be used for partitioning.</span>
<span class="sd">            If None, the charge file will be used for partitioning.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to pass to the Bader class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            A Bader class object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_cube</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_cube</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dynamic</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="nb">format</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;vasp&quot;</span><span class="p">,</span> <span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Bader class object from VASP or .cube files. If no format is</span>
<span class="sd">        provided the method will automatically try and determine the file type</span>
<span class="sd">        from the name</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        charge_filename : Path | str</span>
<span class="sd">            The path to the file containing the charge density that will be</span>
<span class="sd">            integrated.</span>
<span class="sd">        reference_filename : Path | None | str, optional</span>
<span class="sd">            The path to the file that will be used for partitioning.</span>
<span class="sd">            If None, the charge file will be used for partitioning.</span>
<span class="sd">        format : Literal[&quot;vasp&quot;, &quot;cube&quot;, None], optional</span>
<span class="sd">            The format of the grids to read in. If None, the formats will be</span>
<span class="sd">            guessed from the file names.</span>
<span class="sd">        total_only: bool</span>
<span class="sd">            If true, only the first set of data in the file will be read. This</span>
<span class="sd">            increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">            not used. This is only used if the file format is determined to be</span>
<span class="sd">            VASP, as cube files are assumed to contain only one set of data.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments to pass to the Bader class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            A Bader class object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span>
            <span class="n">charge_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span>
                <span class="n">reference_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            A deep copy of this Bader object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_basin_volumes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">basin_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes bader basins to vasp-like files. Points belonging to the basin</span>
<span class="sd">        will have values from the charge or reference grid, and all other points</span>
<span class="sd">        will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basin_indices : NDArray</span>
<span class="sd">            The list of basin indices to write</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">basin</span> <span class="ow">in</span> <span class="n">basin_indices</span><span class="p">:</span>
            <span class="c1"># get a mask everywhere but the requested basin</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span> <span class="o">!=</span> <span class="n">basin</span>
            <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
            <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
                <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># get prefix</span>
            <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

            <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_b</span><span class="si">{</span><span class="n">basin</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># write file</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_all_basin_volumes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes all bader basins to vasp-like files. Points belonging to the basin</span>
<span class="sd">        will have values from the charge or reference grid, and all other points</span>
<span class="sd">        will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basin_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">significant_basins</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_basin_volumes</span><span class="p">(</span>
            <span class="n">basin_indices</span><span class="o">=</span><span class="n">basin_indices</span><span class="p">,</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">write_reference</span><span class="o">=</span><span class="n">write_reference</span><span class="p">,</span>
            <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix_override</span><span class="p">,</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_basin_volumes_sum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">basin_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the union of the provided bader basins to vasp-like files.</span>
<span class="sd">        Points belonging to the basins will have values from the charge or</span>
<span class="sd">        reference grid, and all other points will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basin_indices : NDArray</span>
<span class="sd">            The list of basin indices to sum and write</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="c1"># create a mask including each of the requested basins</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basin_indices</span><span class="p">)</span>
        <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_bsum&quot;</span>

        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_atom_volumes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">atom_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes atomic basins to vasp-like files. Points belonging to the atom</span>
<span class="sd">        will have values from the charge or reference grid, and all other points</span>
<span class="sd">        will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atom_indices : NDArray</span>
<span class="sd">            The list of atom indices to write</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">atom_index</span> <span class="ow">in</span> <span class="n">atom_indices</span><span class="p">:</span>
            <span class="c1"># get a mask everywhere but the requested basin</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span> <span class="o">!=</span> <span class="n">atom_index</span>
            <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
            <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
                <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># get prefix</span>
            <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

            <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_a</span><span class="si">{</span><span class="n">atom_index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># write file</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_all_atom_volumes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes all atomic basins to vasp-like files. Points belonging to the atom</span>
<span class="sd">        will have values from the charge or reference grid, and all other points</span>
<span class="sd">        will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_atom_volumes</span><span class="p">(</span>
            <span class="n">atom_indices</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">,</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">write_reference</span><span class="o">=</span><span class="n">write_reference</span><span class="p">,</span>
            <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix_override</span><span class="p">,</span>
            <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
            <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_atom_volumes_sum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">atom_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the union of the provided atom basins to vasp-like files.</span>
<span class="sd">        Points belonging to the atoms will have values from the charge or</span>
<span class="sd">        reference grid, and all other points will be 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atom_indices : NDArray</span>
<span class="sd">            The list of atom indices to sum and write</span>
<span class="sd">        directory : str | Path</span>
<span class="sd">            The directory to write the files in. If None, the active directory</span>
<span class="sd">            is used.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            Default is False.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the data to use</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">)</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_asum&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_species_volume</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the charge density or reference file for all atoms of the given</span>
<span class="sd">        species to a single file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        species : str, optional</span>
<span class="sd">            The species to write.</span>
<span class="sd">        directory : str | Path, optional</span>
<span class="sd">            The directory to write the result to. The default is None.</span>
<span class="sd">        write_reference : bool, optional</span>
<span class="sd">            Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">            The default is True.</span>
<span class="sd">        prefix_override : str, optional</span>
<span class="sd">            The string to add at the front of the output path. If None, defaults</span>
<span class="sd">            to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">            grid.</span>
<span class="sd">        output_format : str | Format, optional</span>
<span class="sd">            The format to write with. If None, writes to source format stored in</span>
<span class="sd">            the Grid objects metadata.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="c1"># Get voxel assignments and data</span>
        <span class="n">voxel_assignment_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span>
        <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># add dummy atoms if desired</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">indices_from_symbol</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>

        <span class="c1"># Get mask where the grid belongs to requested species</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">voxel_assignment_array</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">total</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">diff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_atom_results_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects a summary of results for the atoms in a pandas DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        atoms_df : pd.DataFrame</span>
<span class="sd">            A table summarizing the atomic basins.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get atom results summary</span>
        <span class="n">atom_frac_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span>
        <span class="n">atoms_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span><span class="p">,</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_volumes</span><span class="p">,</span>
                <span class="s2">&quot;surface_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_min_surface_distances</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">atoms_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_basin_results_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects a summary of results for the basins in a pandas DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basin_df : pd.DataFrame</span>
<span class="sd">            A table summarizing the basins.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significant_basins</span>
        <span class="n">basin_frac_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>
        <span class="n">basin_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;atoms&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">labels</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_atoms</span><span class="p">[</span><span class="n">subset</span><span class="p">]],</span>
                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_charges</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_volumes</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
                <span class="s2">&quot;surface_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_min_surface_distances</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
                <span class="s2">&quot;atom_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_atom_dists</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">basin_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_atom_tsv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader_atoms.tsv&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a summary of atom results to .tsv files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str | Path</span>
<span class="sd">            The Path to write the results to. The default is &quot;bader_atoms.tsv&quot;.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="c1"># Get atom results summary</span>
        <span class="n">atoms_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_atom_results_dataframe</span><span class="p">()</span>
        <span class="n">formatted_atoms_df</span> <span class="o">=</span> <span class="n">atoms_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Determine max width per column including header</span>
        <span class="n">col_widths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">col</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">atoms_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">}</span>

        <span class="c1"># Note what we&#39;re writing in log</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing Atom Summary to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># write output summaries</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># Write header</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Write rows</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># write vacuum summary to atom file</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vacuum Charge:</span><span class="se">\t\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_charge</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vacuum Volume:</span><span class="se">\t\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_volume</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Electrons:</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_electron_number</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Volume:</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_volume</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_basin_tsv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader_basins.tsv&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a summary of basin results to .tsv files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str | Path</span>
<span class="sd">            The Path to write the results to. The default is &quot;bader_basins.tsv&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="c1"># Get basin results summary</span>
        <span class="n">basin_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_basin_results_dataframe</span><span class="p">()</span>
        <span class="n">formatted_basin_df</span> <span class="o">=</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">formatted_basin_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Determine max width per column including header</span>
        <span class="n">col_widths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">col</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">}</span>

        <span class="c1"># Write to file with aligned columns using tab as separator</span>

        <span class="c1"># Note what we&#39;re writing in log</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing Basin Summary to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># write output summaries</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="c1"># Write header</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Write rows</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">formatted_basin_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span>
        <span class="n">use_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Gets a dictionary summary of the Bader analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        potcar_path : Path | str, optional</span>
<span class="sd">            The Path to a POTCAR file. This must be provided for oxidation states</span>
<span class="sd">            to be calculated, and they will be None otherwise. The default is &quot;POTCAR&quot;.</span>
<span class="sd">        use_json : bool, optional</span>
<span class="sd">            Convert all entries to JSONable data types. The default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A summary of the BadELF analysis in dictionary form.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get charges first to ensure good logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># collect method kwargs</span>
        <span class="n">method_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
            <span class="s2">&quot;vacuum_tol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_tol</span><span class="p">,</span>
            <span class="s2">&quot;basin_tol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_tol</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;method_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method_kwargs</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_from_potcar</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>

        <span class="c1"># split into basin and atom sections</span>
        <span class="n">atom_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;species&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_charges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_volumes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_min_surface_distances&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_avg_surface_distances&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">atom_results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">basin_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;basin_atoms&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_atom_dists&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_charges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_volumes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_frac&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_charge_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_ref_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_vox&quot;</span><span class="p">,</span>
            <span class="s2">&quot;significant_basins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_min_surface_distances&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_avg_surface_distances&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">basin_results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vacuum_charge&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vacuum_volume&quot;</span><span class="p">,</span>
            <span class="s2">&quot;num_vacuum&quot;</span><span class="p">,</span>
            <span class="s2">&quot;total_electron_number&quot;</span><span class="p">,</span>
            <span class="s2">&quot;total_volume&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_json</span><span class="p">:</span>
            <span class="c1"># get serializable versions of each attribute</span>
            <span class="n">results</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;POSCAR&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;basin_maxima_frac&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_charge_values&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_ref_values&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_maxima_vox&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_charges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_volumes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;significant_basins&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_min_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_avg_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_atoms&quot;</span><span class="p">,</span>
                <span class="s2">&quot;basin_atom_dists&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># skip oxidation states if they fail</span>
                <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;atom_charges&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_volumes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_min_surface_distances&quot;</span><span class="p">,</span>
                <span class="s2">&quot;atom_avg_surface_distances&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="k">if</span> <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># skip oxidation states if they fail</span>
                <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;atom_results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_results</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;basin_results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">basin_results</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a JSON string representation of the results, typically for writing</span>
<span class="sd">        results to file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for the to_dict method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A JSON string representation of the BadELF results.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader.json&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes results of the analysis to file in a JSON format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : Path | str, optional</span>
<span class="sd">            The Path to write the results to. The default is &quot;bader.json&quot;.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            keyword arguments for the to_dict method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_avg_surface_distances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_avg_surface_distances</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_avg_surface_distances" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The avg distance from each atom to the edges of its basin</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_charges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_charges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_charges" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge assigned to each atom</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_edges" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mask with the same shape as the input grids that is True at points
on atom edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_labels" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 3D array of the same shape as the reference grid with entries
representing the atoms the voxel belongs to.</p>
<p>Note that for some methods (e.g. weight) some voxels have fractional
assignments for each basin and this will not represent exactly how
charges are assigned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_min_surface_distances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_min_surface_distances</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_min_surface_distances" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance from each atom to the nearest point on the atoms surface.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.atom_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">atom_volumes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.atom_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The volume assigned to each atom</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_atom_dists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_atom_dists</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_atom_dists" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance from each attractor to the nearest atom</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_atoms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_atoms</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_atoms" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The atom index of each basin is assigned to.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_avg_surface_distances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_avg_surface_distances</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_avg_surface_distances" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The avg distance from each basin maxima to the edges of its basin</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_charges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_charges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_charges" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charges assigned to each attractor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_edges" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mask with the same shape as the input grids that is True at points
on basin edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_labels" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 3D array of the same shape as the reference grid with entries
representing the basin the voxel belongs to. Note that for some
methods (e.g. weight) the voxels have weights for each basin.
These will be stored in the basin_weights property.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_maxima_charge_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_maxima_charge_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_maxima_charge_values" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge data value at each maximum. If the maximum is
off grid, this value will be interpolated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_maxima_frac" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_maxima_frac</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_maxima_frac" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fractional coordinates of each attractor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_maxima_ref_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_maxima_ref_values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_maxima_ref_values" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reference data value at each maximum. If the maximum is
off grid, this value will be interpolated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_maxima_vox" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_maxima_vox</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_maxima_vox" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The voxel coordinates of each attractor. There may be more of these
than the fractional coordinates, as some maxima sit exactly between
several voxels.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_min_surface_distances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_min_surface_distances</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_min_surface_distances" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance from each basin maxima to the nearest point on
the basins surface</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_tol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_tol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_tol" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value below which a basin will not be considered significant. This
is used to avoid writing out data that is likely not valuable.
The default is 0.001.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.basin_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basin_volumes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.basin_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The volume assigned to each attractor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.charge_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">charge_grid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.charge_grid" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.toolkit.Grid">Grid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Grid object with the charge density that will be integrated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.method" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">method</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.method" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The algorithm to use for generating bader basins. If None, defaults
to neargrid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.num_vacuum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_vacuum</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.num_vacuum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of vacuum points in the array</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.reference_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reference_grid</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.reference_grid" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.toolkit.Grid">Grid</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A grid object whose values will be used to construct the basins.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.significant_basins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">significant_basins</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.significant_basins" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D mask with an entry for each basin that is True where basins
are significant.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.species" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">species</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.species" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The species of each atom/dummy atom in the electride structure. Covalent
and metallic features are not included.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">structure</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.structure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="baderkit.core.toolkit.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pymatgen structure basins are assigned to.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.total_electron_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_electron_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.total_electron_number" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total number of electrons in the system calculated from the
atom charges and vacuum charge. If this does not match the true
total electron number within reasonable floating point error,
there is a major problem.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.total_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.total_volume" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total volume integrated in the system. This should match the
volume of the structure. If it does not there may be a serious problem.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.use_reference_vacuum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">use_reference_vacuum</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.use_reference_vacuum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to use the reference file to determine regions of vacuum
(low charge density). This should generally be set to True unless the
ELF is being used as the reference. The default is True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.vacuum_charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_charge</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.vacuum_charge" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge assigned to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.vacuum_mask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_mask</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.vacuum_mask" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mask representing the voxels that belong to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.vacuum_tol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_tol</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.vacuum_tol" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value below which a point will be considered part of the vacuum.
The default is 0.001.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="src.baderkit.core.bader.Bader.vacuum_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vacuum_volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.vacuum_volume" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total volume assigned to the vacuum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.all_methods" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_methods</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.all_methods" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of the available methods.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">all_methods</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list[str]</span>
<span class="sd">        A list of the available methods.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Method</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

<a href="#src.baderkit.core.bader.Bader.copy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">



    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="src.baderkit.core.bader.bader.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of this Bader object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Self</span>
<span class="sd">        A deep copy of this Bader object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.from_cube" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_cube</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">reference_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.from_cube" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a Bader class object from .cube files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the .cube file that will be used for summing charge.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to .cube file that will be used for partitioning.
If None, the charge file will be used for partitioning.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Bader class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="src.baderkit.core.bader.bader.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Bader class object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_cube</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Bader class object from .cube files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_filename : Path | str, optional</span>
<span class="sd">        The path to the .cube file that will be used for summing charge.</span>
<span class="sd">    reference_filename : Path | None | str, optional</span>
<span class="sd">        The path to .cube file that will be used for partitioning.</span>
<span class="sd">        If None, the charge file will be used for partitioning.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments to pass to the Bader class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Self</span>
<span class="sd">        A Bader class object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_cube</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_cube</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.from_dynamic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dynamic</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">reference_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.from_dynamic" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a Bader class object from VASP or .cube files. If no format is
provided the method will automatically try and determine the file type
from the name</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file containing the charge density that will be
integrated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file that will be used for partitioning.
If None, the charge file will be used for partitioning.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;vasp&#39;, &#39;cube&#39;, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format of the grids to read in. If None, the formats will be
guessed from the file names.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, only the first set of data in the file will be read. This
increases speed and reduced memory usage as the other data is typically
not used. This is only used if the file format is determined to be
VASP, as cube files are assumed to contain only one set of data.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Bader class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="src.baderkit.core.bader.bader.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Bader class object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dynamic</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">format</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;vasp&quot;</span><span class="p">,</span> <span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Bader class object from VASP or .cube files. If no format is</span>
<span class="sd">    provided the method will automatically try and determine the file type</span>
<span class="sd">    from the name</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_filename : Path | str</span>
<span class="sd">        The path to the file containing the charge density that will be</span>
<span class="sd">        integrated.</span>
<span class="sd">    reference_filename : Path | None | str, optional</span>
<span class="sd">        The path to the file that will be used for partitioning.</span>
<span class="sd">        If None, the charge file will be used for partitioning.</span>
<span class="sd">    format : Literal[&quot;vasp&quot;, &quot;cube&quot;, None], optional</span>
<span class="sd">        The format of the grids to read in. If None, the formats will be</span>
<span class="sd">        guessed from the file names.</span>
<span class="sd">    total_only: bool</span>
<span class="sd">        If true, only the first set of data in the file will be read. This</span>
<span class="sd">        increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">        not used. This is only used if the file format is determined to be</span>
<span class="sd">        VASP, as cube files are assumed to contain only one set of data.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments to pass to the Bader class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Self</span>
<span class="sd">        A Bader class object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span>
        <span class="n">charge_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span>
            <span class="n">reference_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.from_vasp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="o">=</span><span class="s1">&#39;CHGCAR&#39;</span><span class="p">,</span> <span class="n">reference_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#src.baderkit.core.bader.Bader.from_vasp" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a Bader class object from VASP files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>charge_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the CHGCAR like file that will be used for summing charge.
The default is "CHGCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;CHGCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference_filename</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to CHGCAR like file that will be used for partitioning.
If None, the charge file will be used for partitioning.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, only the first set of data in the file will be read. This
increases speed and reduced memory usage as the other data is typically
not used.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Bader class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="src.baderkit.core.bader.bader.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Bader class object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_vasp</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">charge_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CHGCAR&quot;</span><span class="p">,</span>
    <span class="n">reference_filename</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">total_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Bader class object from VASP files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    charge_filename : Path | str, optional</span>
<span class="sd">        The path to the CHGCAR like file that will be used for summing charge.</span>
<span class="sd">        The default is &quot;CHGCAR&quot;.</span>
<span class="sd">    reference_filename : Path | None | str, optional</span>
<span class="sd">        The path to CHGCAR like file that will be used for partitioning.</span>
<span class="sd">        If None, the charge file will be used for partitioning.</span>
<span class="sd">    total_only: bool</span>
<span class="sd">        If true, only the first set of data in the file will be read. This</span>
<span class="sd">        increases speed and reduced memory usage as the other data is typically</span>
<span class="sd">        not used.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments to pass to the Bader class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Self</span>
<span class="sd">        A Bader class object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">charge_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">charge_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_vasp</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">,</span> <span class="n">total_only</span><span class="o">=</span><span class="n">total_only</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">charge_grid</span><span class="o">=</span><span class="n">charge_grid</span><span class="p">,</span> <span class="n">reference_grid</span><span class="o">=</span><span class="n">reference_grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.get_atom_results_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_atom_results_dataframe</span><span class="p">()</span></code>

<a href="#src.baderkit.core.bader.Bader.get_atom_results_dataframe" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Collects a summary of results for the atoms in a pandas DataFrame.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>atoms_df</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A table summarizing the atomic basins.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_atom_results_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collects a summary of results for the atoms in a pandas DataFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    atoms_df : pd.DataFrame</span>
<span class="sd">        A table summarizing the atomic basins.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get atom results summary</span>
    <span class="n">atom_frac_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span>
    <span class="n">atoms_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">atom_frac_coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span><span class="p">,</span>
            <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_volumes</span><span class="p">,</span>
            <span class="s2">&quot;surface_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_min_surface_distances</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">atoms_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.get_basin_results_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_basin_results_dataframe</span><span class="p">()</span></code>

<a href="#src.baderkit.core.bader.Bader.get_basin_results_dataframe" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Collects a summary of results for the basins in a pandas DataFrame.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>basin_df</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A table summarizing the basins.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_basin_results_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collects a summary of results for the basins in a pandas DataFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    basin_df : pd.DataFrame</span>
<span class="sd">        A table summarizing the basins.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significant_basins</span>
    <span class="n">basin_frac_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span>
    <span class="n">basin_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;atoms&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">labels</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_atoms</span><span class="p">[</span><span class="n">subset</span><span class="p">]],</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">basin_frac_coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_charges</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_volumes</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="s2">&quot;surface_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_min_surface_distances</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="s2">&quot;atom_dist&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_atom_dists</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">basin_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.get_oxidation_from_potcar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_oxidation_from_potcar</span><span class="p">(</span><span class="n">potcar_path</span><span class="o">=</span><span class="s1">&#39;POTCAR&#39;</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.get_oxidation_from_potcar" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the oxidation state of each atom from the provided POTCAR
file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>potcar_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the POTCAR to calculate oxidation states from. The default is "POTCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;POTCAR&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The oxidation state of each atom in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_oxidation_from_potcar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the oxidation state of each atom from the provided POTCAR</span>
<span class="sd">    file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    potcar_path : Path, optional</span>
<span class="sd">        The path to the POTCAR to calculate oxidation states from. The default is &quot;POTCAR&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NDArray</span>
<span class="sd">        The oxidation state of each atom in the structure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert to path</span>
    <span class="n">potcar_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">potcar_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;No POTCAR file found in the requested directory. Oxidation states cannot be calculated&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>
    <span class="c1"># load</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">potcars</span> <span class="o">=</span> <span class="n">Potcar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>
    <span class="n">nelectron_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># the result is a list because there can be multiple element potcars</span>
    <span class="c1"># in the file (e.g. for NaCl, POTCAR = POTCAR_Na + POTCAR_Cl)</span>
    <span class="k">for</span> <span class="n">potcar</span> <span class="ow">in</span> <span class="n">potcars</span><span class="p">:</span>
        <span class="n">nelectron_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">potcar</span><span class="o">.</span><span class="n">element</span><span class="p">:</span> <span class="n">potcar</span><span class="o">.</span><span class="n">nelectrons</span><span class="p">})</span>
    <span class="c1"># calculate oxidation states</span>
    <span class="n">oxi_state_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">site</span><span class="p">,</span> <span class="n">site_charge</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span><span class="p">):</span>
        <span class="n">element_str</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">name</span>
        <span class="n">oxi_state</span> <span class="o">=</span> <span class="n">nelectron_data</span><span class="p">[</span><span class="n">element_str</span><span class="p">]</span> <span class="o">-</span> <span class="n">site_charge</span>
        <span class="n">oxi_state_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oxi_state</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">oxi_state_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.run_atom_assignment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_atom_assignment</span><span class="p">()</span></code>

<a href="#src.baderkit.core.bader.Bader.run_atom_assignment" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Assigns bader basins to this Bader objects structure.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_atom_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns bader basins to this Bader objects structure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ensure bader has run (otherwise our time will include the bader time)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">basin_maxima_frac</span>

    <span class="c1"># Default structure</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>

    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Assigning Atom Properties&quot;</span><span class="p">)</span>
    <span class="c1"># get basin assignments for this bader objects structure</span>
    <span class="n">atom_labels</span><span class="p">,</span> <span class="n">atom_charges</span><span class="p">,</span> <span class="n">atom_volumes</span><span class="p">,</span> <span class="n">basin_atoms</span><span class="p">,</span> <span class="n">basin_atom_dists</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assign_basins_to_structure</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Store everything</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atoms</span> <span class="o">=</span> <span class="n">basin_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_basin_atom_dists</span> <span class="o">=</span> <span class="n">basin_atom_dists</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atom_labels</span> <span class="o">=</span> <span class="n">atom_labels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atom_charges</span> <span class="o">=</span> <span class="n">atom_charges</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atom_volumes</span> <span class="o">=</span> <span class="n">atom_volumes</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Atom Assignment Finished&quot;</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.run_bader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_bader</span><span class="p">()</span></code>

<a href="#src.baderkit.core.bader.Bader.run_bader" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Runs the entire Bader process and saves results to class variables.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_bader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the entire Bader process and saves results to class variables.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Beginning Bader Algorithm Using &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; Method&quot;</span><span class="p">)</span>
    <span class="c1"># Normalize the method name to a module and class name</span>
    <span class="n">module_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span>
    <span class="p">)</span>  <span class="c1"># &#39;pseudo-neargrid&#39; -&gt; &#39;pseudo_neargrid&#39;</span>
    <span class="n">class_name</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">module_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;Method&quot;</span>
    <span class="p">)</span>

    <span class="c1"># import method</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;baderkit.core.bader.methods.</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">Method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>

    <span class="c1"># Instantiate and run the selected method</span>
    <span class="n">method</span> <span class="o">=</span> <span class="n">Method</span><span class="p">(</span>
        <span class="n">charge_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="p">,</span>
        <span class="n">reference_grid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="p">,</span>
        <span class="n">vacuum_mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_mask</span><span class="p">,</span>
        <span class="n">num_vacuum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_vacuum</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_overdetermined</span><span class="p">:</span>
        <span class="n">method</span><span class="o">.</span><span class="n">_use_overdetermined</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bader Algorithm Complete&quot;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">(</span><span class="n">potcar_path</span><span class="o">=</span><span class="s1">&#39;POTCAR&#39;</span><span class="p">,</span> <span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.to_dict" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Gets a dictionary summary of the Bader analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>potcar_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to a POTCAR file. This must be provided for oxidation states
to be calculated, and they will be None otherwise. The default is "POTCAR".</p>
              </div>
            </td>
            <td>
                  <code>&#39;POTCAR&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_json</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convert all entries to JSONable data types. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A summary of the BadELF analysis in dictionary form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">potcar_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POTCAR&quot;</span><span class="p">,</span>
    <span class="n">use_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Gets a dictionary summary of the Bader analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    potcar_path : Path | str, optional</span>
<span class="sd">        The Path to a POTCAR file. This must be provided for oxidation states</span>
<span class="sd">        to be calculated, and they will be None otherwise. The default is &quot;POTCAR&quot;.</span>
<span class="sd">    use_json : bool, optional</span>
<span class="sd">        Convert all entries to JSONable data types. The default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A summary of the BadELF analysis in dictionary form.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get charges first to ensure good logging</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atom_charges</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># collect method kwargs</span>
    <span class="n">method_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
        <span class="s2">&quot;vacuum_tol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum_tol</span><span class="p">,</span>
        <span class="s2">&quot;basin_tol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_tol</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;method_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">method_kwargs</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;oxidation_states&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_oxidation_from_potcar</span><span class="p">(</span><span class="n">potcar_path</span><span class="p">)</span>

    <span class="c1"># split into basin and atom sections</span>
    <span class="n">atom_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;species&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_charges&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_volumes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_min_surface_distances&quot;</span><span class="p">,</span>
        <span class="s2">&quot;atom_avg_surface_distances&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">atom_results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">basin_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;basin_atoms&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_atom_dists&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_charges&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_volumes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_maxima_frac&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_maxima_charge_values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_maxima_ref_values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_maxima_vox&quot;</span><span class="p">,</span>
        <span class="s2">&quot;significant_basins&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_min_surface_distances&quot;</span><span class="p">,</span>
        <span class="s2">&quot;basin_avg_surface_distances&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">basin_results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vacuum_charge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vacuum_volume&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_vacuum&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_electron_number&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_volume&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_json</span><span class="p">:</span>
        <span class="c1"># get serializable versions of each attribute</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;POSCAR&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;basin_maxima_frac&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_charge_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_ref_values&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_maxima_vox&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_charges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_volumes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;significant_basins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_min_surface_distances&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_avg_surface_distances&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_atoms&quot;</span><span class="p">,</span>
            <span class="s2">&quot;basin_atom_dists&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># skip oxidation states if they fail</span>
            <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">basin_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;atom_charges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_volumes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_min_surface_distances&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atom_avg_surface_distances&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># skip oxidation states if they fail</span>
            <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;atom_results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom_results</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;basin_results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">basin_results</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.to_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.to_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a JSON string representation of the results, typically for writing
results to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments for the to_dict method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JSON string representation of the BadELF results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a JSON string representation of the results, typically for writing</span>
<span class="sd">    results to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for the to_dict method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A JSON string representation of the BadELF results.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_all_atom_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_all_atom_volumes</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_all_atom_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes all atomic basins to vasp-like files. Points belonging to the atom
will have values from the charge or reference grid, and all other points
will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_all_atom_volumes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes all atomic basins to vasp-like files. Points belonging to the atom</span>
<span class="sd">    will have values from the charge or reference grid, and all other points</span>
<span class="sd">    will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_atom_volumes</span><span class="p">(</span>
        <span class="n">atom_indices</span><span class="o">=</span><span class="n">atom_indices</span><span class="p">,</span>
        <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="o">=</span><span class="n">write_reference</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix_override</span><span class="p">,</span>
        <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_all_basin_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_all_basin_volumes</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_all_basin_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes all bader basins to vasp-like files. Points belonging to the basin
will have values from the charge or reference grid, and all other points
will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_all_basin_volumes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes all bader basins to vasp-like files. Points belonging to the basin</span>
<span class="sd">    will have values from the charge or reference grid, and all other points</span>
<span class="sd">    will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basin_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">significant_basins</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_basin_volumes</span><span class="p">(</span>
        <span class="n">basin_indices</span><span class="o">=</span><span class="n">basin_indices</span><span class="p">,</span>
        <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
        <span class="n">write_reference</span><span class="o">=</span><span class="n">write_reference</span><span class="p">,</span>
        <span class="n">prefix_override</span><span class="o">=</span><span class="n">prefix_override</span><span class="p">,</span>
        <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
        <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_atom_tsv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_atom_tsv</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;bader_atoms.tsv&#39;</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_atom_tsv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes a summary of atom results to .tsv files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to write the results to. The default is "bader_atoms.tsv".</p>
              </div>
            </td>
            <td>
                  <code>&#39;bader_atoms.tsv&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_atom_tsv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader_atoms.tsv&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes a summary of atom results to .tsv files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str | Path</span>
<span class="sd">        The Path to write the results to. The default is &quot;bader_atoms.tsv&quot;.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="c1"># Get atom results summary</span>
    <span class="n">atoms_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_atom_results_dataframe</span><span class="p">()</span>
    <span class="n">formatted_atoms_df</span> <span class="o">=</span> <span class="n">atoms_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Determine max width per column including header</span>
    <span class="n">col_widths</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">col</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">formatted_atoms_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">atoms_df</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">}</span>

    <span class="c1"># Note what we&#39;re writing in log</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing Atom Summary to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># write output summaries</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Write header</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Write rows</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">formatted_atoms_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># write vacuum summary to atom file</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vacuum Charge:</span><span class="se">\t\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_charge</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vacuum Volume:</span><span class="se">\t\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vacuum_volume</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Electrons:</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_electron_number</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Volume:</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_volume</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_atom_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_atom_volumes</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_atom_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes atomic basins to vasp-like files. Points belonging to the atom
will have values from the charge or reference grid, and all other points
will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>atom_indices</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of atom indices to write</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_atom_volumes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">atom_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes atomic basins to vasp-like files. Points belonging to the atom</span>
<span class="sd">    will have values from the charge or reference grid, and all other points</span>
<span class="sd">    will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atom_indices : NDArray</span>
<span class="sd">        The list of atom indices to write</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atom_index</span> <span class="ow">in</span> <span class="n">atom_indices</span><span class="p">:</span>
        <span class="c1"># get a mask everywhere but the requested basin</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span> <span class="o">!=</span> <span class="n">atom_index</span>
        <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_a</span><span class="si">{</span><span class="n">atom_index</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_atom_volumes_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_atom_volumes_sum</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_atom_volumes_sum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the union of the provided atom basins to vasp-like files.
Points belonging to the atoms will have values from the charge or
reference grid, and all other points will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>atom_indices</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of atom indices to sum and write</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_atom_volumes_sum</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">atom_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the union of the provided atom basins to vasp-like files.</span>
<span class="sd">    Points belonging to the atoms will have values from the charge or</span>
<span class="sd">    reference grid, and all other points will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    atom_indices : NDArray</span>
<span class="sd">        The list of atom indices to sum and write</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">)</span>
    <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_array_copy</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
        <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_asum&quot;</span>
    <span class="c1"># write file</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_basin_tsv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_basin_tsv</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;bader_basins.tsv&#39;</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_basin_tsv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes a summary of basin results to .tsv files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to write the results to. The default is "bader_basins.tsv".</p>
              </div>
            </td>
            <td>
                  <code>&#39;bader_basins.tsv&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_basin_tsv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader_basins.tsv&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes a summary of basin results to .tsv files.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str | Path</span>
<span class="sd">        The Path to write the results to. The default is &quot;bader_basins.tsv&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="c1"># Get basin results summary</span>
    <span class="n">basin_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_basin_results_dataframe</span><span class="p">()</span>
    <span class="n">formatted_basin_df</span> <span class="o">=</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">formatted_basin_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Determine max width per column including header</span>
    <span class="n">col_widths</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">col</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">formatted_basin_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">}</span>

    <span class="c1"># Write to file with aligned columns using tab as separator</span>

    <span class="c1"># Note what we&#39;re writing in log</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing Basin Summary to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># write output summaries</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Write header</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">basin_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Write rows</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">formatted_basin_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">col_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_basin_volumes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_basin_volumes</span><span class="p">(</span><span class="n">basin_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_basin_volumes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes bader basins to vasp-like files. Points belonging to the basin
will have values from the charge or reference grid, and all other points
will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>basin_indices</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of basin indices to write</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_basin_volumes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">basin_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes bader basins to vasp-like files. Points belonging to the basin</span>
<span class="sd">    will have values from the charge or reference grid, and all other points</span>
<span class="sd">    will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basin_indices : NDArray</span>
<span class="sd">        The list of basin indices to write</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">basin</span> <span class="ow">in</span> <span class="n">basin_indices</span><span class="p">:</span>
        <span class="c1"># get a mask everywhere but the requested basin</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span> <span class="o">!=</span> <span class="n">basin</span>
        <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
        <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data_array_copy</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
            <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># get prefix</span>
        <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_b</span><span class="si">{</span><span class="n">basin</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_basin_volumes_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_basin_volumes_sum</span><span class="p">(</span><span class="n">basin_indices</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_basin_volumes_sum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the union of the provided bader basins to vasp-like files.
Points belonging to the basins will have values from the charge or
reference grid, and all other points will be 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>basin_indices</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of basin indices to sum and write</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the files in. If None, the active directory
is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_basin_volumes_sum</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">basin_indices</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the union of the provided bader basins to vasp-like files.</span>
<span class="sd">    Points belonging to the basins will have values from the charge or</span>
<span class="sd">    reference grid, and all other points will be 0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basin_indices : NDArray</span>
<span class="sd">        The list of basin indices to sum and write</span>
<span class="sd">    directory : str | Path</span>
<span class="sd">        The directory to write the files in. If None, the active directory</span>
<span class="sd">        is used.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data to use</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">data_type</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">total</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">data_type</span>

    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="c1"># create a mask including each of the requested basins</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basin_labels</span><span class="p">,</span> <span class="n">basin_indices</span><span class="p">)</span>
    <span class="c1"># copy data to avoid overwriting. Set data off of basin to 0</span>
    <span class="n">data_array_copy</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_array_copy</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span>
        <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">data_array_copy</span><span class="p">},</span>
        <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_bsum&quot;</span>

    <span class="c1"># write file</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span> <span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_json</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;bader.json&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_json" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes results of the analysis to file in a JSON format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path to write the results to. The default is "bader.json".</p>
              </div>
            </td>
            <td>
                  <code>&#39;bader.json&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keyword arguments for the to_dict method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bader.json&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes results of the analysis to file in a JSON format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : Path | str, optional</span>
<span class="sd">        The Path to write the results to. The default is &quot;bader.json&quot;.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        keyword arguments for the to_dict method.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">use_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.baderkit.core.bader.Bader.write_species_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_species_volume</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_reference</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prefix_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#src.baderkit.core.bader.Bader.write_species_volume" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Writes the charge density or reference file for all atoms of the given
species to a single file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>species</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The species to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to write the result to. The default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to write the reference data rather than the charge data.
The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix_override</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string to add at the front of the output path. If None, defaults
to the VASP file name equivalent to the data type stored in the
grid.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="baderkit.core.utilities.file_parsers.Format">Format</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format to write with. If None, writes to source format stored in
the Grid objects metadata.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/baderkit/core/bader/bader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_species_volume</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">write_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">prefix_override</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Format</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the charge density or reference file for all atoms of the given</span>
<span class="sd">    species to a single file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    species : str, optional</span>
<span class="sd">        The species to write.</span>
<span class="sd">    directory : str | Path, optional</span>
<span class="sd">        The directory to write the result to. The default is None.</span>
<span class="sd">    write_reference : bool, optional</span>
<span class="sd">        Whether or not to write the reference data rather than the charge data.</span>
<span class="sd">        The default is True.</span>
<span class="sd">    prefix_override : str, optional</span>
<span class="sd">        The string to add at the front of the output path. If None, defaults</span>
<span class="sd">        to the VASP file name equivalent to the data type stored in the</span>
<span class="sd">        grid.</span>
<span class="sd">    output_format : str | Format, optional</span>
<span class="sd">        The format to write with. If None, writes to source format stored in</span>
<span class="sd">        the Grid objects metadata.</span>
<span class="sd">        Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

    <span class="c1"># Get voxel assignments and data</span>
    <span class="n">voxel_assignment_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_labels</span>
    <span class="k">if</span> <span class="n">write_reference</span><span class="p">:</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_grid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># add dummy atoms if desired</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">indices_from_symbol</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>

    <span class="c1"># Get mask where the grid belongs to requested species</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">voxel_assignment_array</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">total</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">diff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># get prefix</span>
    <span class="k">if</span> <span class="n">prefix_override</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prefix_override</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">prefix</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_override</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># write file</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.annotate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>